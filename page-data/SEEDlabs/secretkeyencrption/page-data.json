{"componentChunkName":"component---src-templates-blog-post-js","path":"/SEEDlabs/secretkeyencrption/","result":{"data":{"site":{"siteMetadata":{"title":"KunheeKim.Dev","author":"[Kunhee Kim]","siteUrl":"https://kunheekimkr.github.io","comment":{"disqusShortName":"","utterances":"kunheekimkr/kunheekimkr.github.io"},"sponsor":{"buyMeACoffeeId":""}}},"markdownRemark":{"id":"a85b3da5-e2be-56b1-98a6-e7cf2ad9716b","excerpt":"Lab Instructions Task 2: Encryption using Different Ciphers and Mode The objective of this task is to use the  command for the encryption and decryption of various ciphers and modes. FIrst, save the plaintext to encrypt in .  Next, encrypt plain.txt using ,  ,   I have changed…","html":"<p><a href=\"https://seedsecuritylabs.org/Labs_16.04/PDF/Crypto_Encryption.pdf\">Lab Instructions</a></p>\n<h2 id=\"task-2-encryption-using-different-ciphers-and-mode\" style=\"position:relative;\"><a href=\"#task-2-encryption-using-different-ciphers-and-mode\" aria-label=\"task 2 encryption using different ciphers and mode permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Task 2: Encryption using Different Ciphers and Mode</h2>\n<p>The objective of this task is to use the <code class=\"language-text\">openssl enc</code> command for the encryption and decryption of various ciphers and modes.</p>\n<p>FIrst, save the plaintext to encrypt in <code class=\"language-text\">plain.txt</code>.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 469px;\"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 10.666666666666668%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAACCAYAAABYBvyLAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAAfUlEQVQI1yWMSwrDIABEc/9L2DYpghrEZpcqCi4MNKKi95lGs5rPY2Z6LwsopRBCQEoJpRTWdQUhBI/nC845hBBwnufg1lpsnw3HcUBrPXb7/r28gTEG0zzP4IyDcwHGGLz31/g3TmKMSCkh54xSytB+3Pta683SzXpureEPmoeAxRfjJlwAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"2-1\"\n        title=\"2-1\"\n        src=\"/static/f580218c14a36a15571199222928d478/5f759/1.png\"\n        srcset=\"/static/f580218c14a36a15571199222928d478/5a46d/1.png 300w,\n/static/f580218c14a36a15571199222928d478/5f759/1.png 469w\"\n        sizes=\"(max-width: 469px) 100vw, 469px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n    </span></p>\n<p>Next, encrypt plain.txt using <code class=\"language-text\">des-ofb</code>, <code class=\"language-text\">aes-128-cbc</code> , <code class=\"language-text\">-bf-cfb</code></p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 728px;\"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 33%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAHCAYAAAAIy204AAAACXBIWXMAAA7DAAAOwwHHb6hkAAABa0lEQVQozy1R2XKCQBDk/99NlVE55AyHckhE8MCDgocQtMpUiZb+Smdnkoeu2WGbnu5ZSdd1qKoCTdMwHL5D1w1kWYYwjOC5LnTDAHFs24YjYFoW0jTFdrvFcrmE5/uwTAuu4C7ST0h0IDJBlhV8iD5frZAkCeI45j6Koj+EIfexOPtBwBwSjeMElmUijGJISbJAIC5leYLB4A0TWYaiyBiPxzBNE9p0yveqqsIwdMyCGQ9KFgvkeS6cbriS6zwvINFkaqiSgC8iUGT65nseR3YchyPN5zMWKtZrHI9HlPs98wohVNcNuvMZkiImj0Yjsb8h1yxb4XA4oKoqnr7ZbBm0s6IouJZlyXW32/Fw4rdty5DIBbmjGLbtsO26rv9/2qFpGlwuF7RfLbquw1m4uF5/8Hw+Ga/Xi+vj8WBIqqbCFLFM8VKWZcP1fKxFJBKlRdMj+H7AA06nSuAknHzjduvR9z3u9zuDxEj4F0bGtbquGYiFAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"2-2\"\n        title=\"2-2\"\n        src=\"/static/896d4f33484d850d0a8e0453ce23ba6c/cecac/2.png\"\n        srcset=\"/static/896d4f33484d850d0a8e0453ce23ba6c/5a46d/2.png 300w,\n/static/896d4f33484d850d0a8e0453ce23ba6c/0a47e/2.png 600w,\n/static/896d4f33484d850d0a8e0453ce23ba6c/cecac/2.png 728w\"\n        sizes=\"(max-width: 728px) 100vw, 728px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n    </span></p>\n<p>I have changed the key and initial vector based on the key size and block size of each encryption algorithm.</p>\n<table>\n<thead>\n<tr>\n<th align=\"center\"></th>\n<th align=\"center\">des-ofb</th>\n<th align=\"center\">aes-128-cbc</th>\n<th align=\"center\">bf-cfb</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td align=\"center\">Key Size</td>\n<td align=\"center\">56bit</td>\n<td align=\"center\">128 bit</td>\n<td align=\"center\">128 bit</td>\n</tr>\n<tr>\n<td align=\"center\">Block Size</td>\n<td align=\"center\">64 bit</td>\n<td align=\"center\">128 bit</td>\n<td align=\"center\">64 bit</td>\n</tr>\n</tbody>\n</table>\n<p>Using the<code class=\"language-text\">xxd</code>command, we can try reading each encrypted bin file in hexadecimal.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 725px;\"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 21.999999999999996%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAECAYAAACOXx+WAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAA7ElEQVQY0yWP2W6DMBBF+f9faCipRCoKFAiLWMwqEJAEIbEEeOJXbsfug+WRfH3mXEmRZSiKAtM0oWkaPi4XOI6DLEthGDps26HbgGVZYIyJk6Yp8qJA3z8wDAOezxf2fcdxHJCUTxnX6xc8z4Nj21DVG3zfRxzHBPkloI07LXBdF0EQIEkSsJQhy3PUdY2maQjc472+BVTiEB4uKMDDYRgip5kHC7KoqkoY8bcoiv6BwjLDuq5YlgXjOIp5nmdI3zeVqv4IK9e9Q9d18aEsSwKEiMiUgxhB27ZFQ1Zd14ma0zSJmhy0bRvO88QfQKz/w+w+3hgAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"2-3\"\n        title=\"2-3\"\n        src=\"/static/6a708099dab66e986eadd8a2528340cd/a0209/3.png\"\n        srcset=\"/static/6a708099dab66e986eadd8a2528340cd/5a46d/3.png 300w,\n/static/6a708099dab66e986eadd8a2528340cd/0a47e/3.png 600w,\n/static/6a708099dab66e986eadd8a2528340cd/a0209/3.png 725w\"\n        sizes=\"(max-width: 725px) 100vw, 725px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n    </span></p>\n<p>To prove that all encryption algorithms have been correctly done, I decrypted each file again and compared it with <code class=\"language-text\">plain.txt</code>.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 730px;\"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 63.33333333333333%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAANCAYAAACpUE5eAAAACXBIWXMAAA7DAAAOwwHHb6hkAAACaklEQVQ4yz2T6XaqQBCEff9H0MQFUBFQUMCoKCqoMZgTzKLZn6VuV+fqjz4jw1BT/VVbMS0LvV4PTs/Gzc0tbPkdhiFc10Wn00G328Vg4COOY/T7fdlrw5F3vu8jCIaIogjDYSDnPYzCCJVarYbb2xvZHGI6nWEymSBJEsxm0+vvNF0iz3Oki4Wcmeoe181mg8PhgIeHB6zXa2T5BhXDMGEYBizTRLPZQhSPRWwmrgawLBOtliHuHbieJw4HGIjLIAjkXIzRaKRGbNtGu20hjMYUNESooS6r1RruxBVvZxuNRl3267I2RLil7RIDxT0pU0zEYiDLMnW42W5R6XZtBMLDEpbafr2u/HgRV9vuCadYmZG1aVripg3XcbULr+8pZzockiEtsxw5XBcxyxLojiMfGlgIMzK6cLq/v0dRFNd6fHzE09MTjscjymOJl5eXv1AoxJaq1So64ngo6YVyG28lH98PNGmmnyRzbCUMcl4sUrmowOvrK97e3nTVUOiu0+lqEfxslmiSXeHFi9gSkVCUgVCkLEs8Pz+rq4sgq9JsNrU913VgCORQ5mq/3+vIcMaYpC+sOGd8pmCaphJCpkKXOp1OeH9/R4WOImlvtVphPL7DStIqhFeWrbGV1Dhry+VS369Xa51HJkqerPP5rPXx8YHPz09UmBpHIBEmDGchQ3w4FFj9F2FNpn+jxJDm87kKFsUBJxGiq4uYCnoyqGwrk0NsMxdHTC6X2dqJg91uJ/+AXNzuNGm+I7vT6Yyvr6+rEIvPV4fkQhf8kMD/Wtpr21mWK9eyPOpHdMSV9f39rfXz84Pf31/8A8BXNuKRNpzXAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"2-4\"\n        title=\"2-4\"\n        src=\"/static/6f343bb5c1c71aee49a5023cc563fba2/e9beb/4.png\"\n        srcset=\"/static/6f343bb5c1c71aee49a5023cc563fba2/5a46d/4.png 300w,\n/static/6f343bb5c1c71aee49a5023cc563fba2/0a47e/4.png 600w,\n/static/6f343bb5c1c71aee49a5023cc563fba2/e9beb/4.png 730w\"\n        sizes=\"(max-width: 730px) 100vw, 730px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n    </span></p>\n<p>We can see that the decrypted result is same as the original file <code class=\"language-text\">plain.txt</code></p>\n<h2 id=\"task-3-encryption-mode--ecb-vs-cbc\" style=\"position:relative;\"><a href=\"#task-3-encryption-mode--ecb-vs-cbc\" aria-label=\"task 3 encryption mode  ecb vs cbc permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Task 3: Encryption Mode – ECB vs. CBC</h2>\n<p>The objective of this task is to check the difference (insecurity) between ECB and CBC encryption mode by encrypting the given image <code class=\"language-text\">pic_original.bmp</code></p>\n<p>This image is the original image <code class=\"language-text\">pic_original.bmp</code></p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 460px;\"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 29.000000000000004%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAGCAIAAABM9SnKAAAACXBIWXMAAAsSAAALEgHS3X78AAAAwklEQVQY02P4Dwf//v3HBf7+xSrMgKLz7dv/W7b8nzDhf339/9ra/729/9ev///iBVzB779/IegvmMuA0NnV9Z+f/z8j438GBgQCcrm5/5eX47AZqBOiOTwcpJqZGUUzExOQ/OfgAJT/9P13175TdbsOV247uPvGIyRnQ+zfu/d/Tc3/6Oj/np7/PTz+R0T8r6gAeuTvj59A+UdvvwhXtjMUlDJkFBas3YuhGQeAyPz49Xfvzcfbrt/bfPXujRfvgSIAbRAm7LD7g4sAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"pic-original\"\n        title=\"pic-original\"\n        src=\"/static/48c909293f055aea3598c238abb59fdc/08a84/pic_original.png\"\n        srcset=\"/static/48c909293f055aea3598c238abb59fdc/5a46d/pic_original.png 300w,\n/static/48c909293f055aea3598c238abb59fdc/08a84/pic_original.png 460w\"\n        sizes=\"(max-width: 460px) 100vw, 460px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n    </span></p>\n<p>First, Encrypt <code class=\"language-text\">pic_original.bmp</code> in two ways using <code class=\"language-text\">aes-128-ecb</code> and <code class=\"language-text\">aes-128-cbc</code>.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 730px;\"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 24.666666666666664%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAFCAYAAABFA8wzAAAACXBIWXMAAA7DAAAOwwHHb6hkAAABF0lEQVQY0yWQ646CMBCFef+XcAPVFrmLgkUSBZVrZGMt7j9f5exQf3w5nTOTzJlaW9fFer3BoowxOA5DkiQoyxK+55Mv4HkeNhuO/X6PLMsQhSGCgHrbLaIoNl5IXhTHsDjnsG0bhZSoqspwvV5xv9+NLtxuN+O3bYtxGNA0jekv9H2PcRzRdZ15W8xxsFr9IAxCCCHAuTBbJS1Yald8EzK2phQR0jRF4Ps0E8En3e1SyKP8JiTPYsyB7djI85yiHyDo9ICaMZ3NBaezXPMF+fGILM/MTFXXmN+zQc/aoJSC1hpWsZM4F2dUxQXl4QSZSjSXBo/ugfpUoS4XakztBDU8oX9f0NMLalR4DQrzpPH3fOPz+Rj+AQABPOCPr6wSAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"3-1\"\n        title=\"3-1\"\n        src=\"/static/8cd962d768dee00614c8ddb2770ad810/e9beb/1.png\"\n        srcset=\"/static/8cd962d768dee00614c8ddb2770ad810/5a46d/1.png 300w,\n/static/8cd962d768dee00614c8ddb2770ad810/0a47e/1.png 600w,\n/static/8cd962d768dee00614c8ddb2770ad810/e9beb/1.png 730w\"\n        sizes=\"(max-width: 730px) 100vw, 730px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n    </span></p>\n<p>Since the first 54 bytes of a <code class=\"language-text\">.bmp</code> file contains the header information about the picture, the two encrypted files cannot be opened with a picture viewing software. Therefore, replace the first 54 bits with the first 54 bits of the original file using the following command.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 732px;\"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 39.333333333333336%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAICAYAAAD5nd/tAAAACXBIWXMAAA7DAAAOwwHHb6hkAAABo0lEQVQozzVR2XKiUBDl/x+TD8iUzlhCENExKiDbBWQTBAKGcvmWk75t8tDVC7fP0iiTyQSz2QzT6RQvL68wjCWiSEBTNchvqqri/V2H4ziYz1X8X6+xXC55bhgLmKsVVE3DemUiSo5Q/hHYfr/H4eBgs9nA9wMkcQzP9RjE932IUCDLMq7DMESSJBBCcMh5SLnrOtTnM5S3tz/Y7XYwTZMUzGFZFi9st1usSY3sbdtBQGA2EUgS27Lhex6JcJnAsm0Grur6qVDXdewJVFpx6WGapvT4wMo96uVMAkdR9AQkgrIsIaiPyY18L+NUVVD0xYLv5rouq5LyiyJHEAQ8k7ZkLYGEiNi2S+c4nU5MIAGPxxR5nj8tT6Z/6cAadgRmLAxWVOQFHLLxsflgALlcE3vTNGjbFm3TYugHvlvf9xiGAZfLBeM4Pi1HIbG4dGg7RBamKESOo5cgOcTI/BRVWqFOfiKucE5qdHmL8TLidrvher1yyFqRv7zMSuRehsLPUYYFioAy1XK5Lmo0VYOu7tBVLef+/Imv4YsBfuPxeOB+v+MbRgsH2sHHNgUAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"3-2\"\n        title=\"3-2\"\n        src=\"/static/ed8c6b4212d7a9633bf0284ced57ff37/d0cc0/2.png\"\n        srcset=\"/static/ed8c6b4212d7a9633bf0284ced57ff37/5a46d/2.png 300w,\n/static/ed8c6b4212d7a9633bf0284ced57ff37/0a47e/2.png 600w,\n/static/ed8c6b4212d7a9633bf0284ced57ff37/d0cc0/2.png 732w\"\n        sizes=\"(max-width: 732px) 100vw, 732px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n    </span></p>\n<p>Now, open <code class=\"language-text\">new_pic_aes-128-ecb.bmp</code> and <code class=\"language-text\">new_pic_aes-128-cbc.bmp</code> using the image viewer.</p>\n<p>This image is the image encrypted in <code class=\"language-text\">aes-128-ecb</code> mode. <code class=\"language-text\">new_pic_aes-128-ecb.bmp</code></p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 460px;\"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 29.000000000000004%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAGCAIAAABM9SnKAAAACXBIWXMAAAsSAAALEgHS3X78AAAA5UlEQVQY00WQzVLDMAyE85hcuHKlMNAWO7JWUpw6/QOS3DjCgyKnpVx2djT+rF01KpSSiqSUZFGI+gRYtHpyZU4CZfeoHhD03VMjN5ihyuDScZawz1w0DEBmcqx+fcWq+lOYrZrLZlVCWwp95O1c4pg38xAn19KOeftptEMFmKOChYN5yGx/m81aTcchTL1jwbHpArv26znTmb2DAodXjCu8P5JF0+fm1plYOlGLh5wGfTv3dLJw6ngnrTlWAxvw9SA/9/J9F/NLNodrn6UzyZLiejDRxP9nY6ZlkgP2G96t2cg7/wKaB7U4vNJidAAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"new_pic_aes-128-ecb\"\n        title=\"new_pic_aes-128-ecb\"\n        src=\"/static/7a0889ccbc5406d65d87887952bc2fca/08a84/new_pic_aes-128-ecb.png\"\n        srcset=\"/static/7a0889ccbc5406d65d87887952bc2fca/5a46d/new_pic_aes-128-ecb.png 300w,\n/static/7a0889ccbc5406d65d87887952bc2fca/08a84/new_pic_aes-128-ecb.png 460w\"\n        sizes=\"(max-width: 460px) 100vw, 460px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n    </span></p>\n<p>In this image, we can still see the oval shape in the center and the rectangle shape in the bottom right corner.</p>\n<p>This image is the image encrypted in <code class=\"language-text\">aes-128-cbc</code> mode. <code class=\"language-text\">new_pic_aes-128-cbc.bmp</code></p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 460px;\"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 29.000000000000004%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAGCAIAAABM9SnKAAAACXBIWXMAAAsSAAALEgHS3X78AAAA1UlEQVQY0xWQC24EIQxD59ZbJj87gen21vVISEEJdvy4Ah9kskBwTUXXU5VhN5BReW8cn47qdtu1iFPZP9WJ+3vtOx15CMxmlyHpDVhg3IGCGRwlf6plE2DIzDnOi7poAF+SMiOrSbfwmmpMzscPmr+DwzjORmy0dZynrx7P1OnYs2RuoOVAe2h680ZysL6TChWD6p15VDd5hZIVObvYLY3ZXq8SqQ6zfcZD60oQbdH2hBBGRMZrXKC5FBiiyTIPf4MI5exBjj6R1ZZiEJyQRlCbaX/zDyP4s1TEz1iRAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"new_pic_aes-128-cbc\"\n        title=\"new_pic_aes-128-cbc\"\n        src=\"/static/bcb67e87310cb23120274a38956e6be7/08a84/new_pic_aes-128-cbc.png\"\n        srcset=\"/static/bcb67e87310cb23120274a38956e6be7/5a46d/new_pic_aes-128-cbc.png 300w,\n/static/bcb67e87310cb23120274a38956e6be7/08a84/new_pic_aes-128-cbc.png 460w\"\n        sizes=\"(max-width: 460px) 100vw, 460px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n    </span></p>\n<p>However in this image, we cannot see the oval shape and the rectangle shape that was in the original image.</p>\n<p>By the result, we can see that CBC encryption mode is more secure than ECB encryption mode. It is because ECB mode encrypts identical plaintext blocks into identical ciphertext blocks and lacks diffusion. While encrypting a bitmap image, large pixels of the same color may be encrypted the same, which leads to the pattern in the original image remain in the encrypted image.</p>\n<h2 id=\"task-4-padding\" style=\"position:relative;\"><a href=\"#task-4-padding\" aria-label=\"task 4 padding permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Task 4: Padding</h2>\n<h3 id=\"1-block-cipher-operation-modes-with-padding\" style=\"position:relative;\"><a href=\"#1-block-cipher-operation-modes-with-padding\" aria-label=\"1 block cipher operation modes with padding permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>1-Block Cipher Operation Modes with Padding</h3>\n<p>The objective of this task is to find out which Block Cipher Operation Modes have paddings and which do not.</p>\n<p>To find out, I prepared a file that contains 9 bytes.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 689px;\"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 3.3333333333333335%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAABCAYAAADeko4lAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAAUUlEQVQI1w3Duw2AIABAQfffQE2kAYNBpZBPpBWVhoqBnl5y3bYaxCTohxHnI/nK1FqJIWCMQUrFmRLW7hzOU0rhfl6Cd2it/wuzUvgQaa3xAbVaPhi+h+2vAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"4-1\"\n        title=\"4-1\"\n        src=\"/static/ac67803c9ea5e219186bab7af8a027ff/0f79a/1.png\"\n        srcset=\"/static/ac67803c9ea5e219186bab7af8a027ff/5a46d/1.png 300w,\n/static/ac67803c9ea5e219186bab7af8a027ff/0a47e/1.png 600w,\n/static/ac67803c9ea5e219186bab7af8a027ff/0f79a/1.png 689w\"\n        sizes=\"(max-width: 689px) 100vw, 689px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n    </span></p>\n<p>Then, I encrypted this file using ECB, CBC, CFB, and OFB mode.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 730px;\"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 39.333333333333336%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAICAYAAAD5nd/tAAAACXBIWXMAAA7DAAAOwwHHb6hkAAABiElEQVQoz0VR226CUBDk///AC6CAiigKKIpWEDTxQmxim/bFaNo/me6sTfswYc+6OzszGq7rYjDwEQyH6Pf7aDSaCCcT5Hku/QEcx0FP+p1OB0EwhM/ZIIDv+/BkdyKzx+MRh8MBVbWDwQE2p9OpkAbodrtSR9gWBXq9nhI5smiaJoa/R9n3BDwWx7ESbrdbZFkGo91uw7YsdGwbrVZLFDbgup6qG41GSNNUwcUsW2KxWCiWS9apOjmfz6Kuwmq1gkGr4/FYQRLLskXxFOv1SlWzP6H64Ek+n88VSZIgiiKsX17UblmWT4W2KKNNz3PButFsSu2pPRLyKgdJVogavonNZiNH19jv93i9XNQ2SQ0qSOJEbURRjIGETTulZBLLm/lGYpf2Z7OZKvtX+DxY10/LabqQDCU35ueIStO0NEMGH8ohLhby55RlpbYuoqSua1XDL99vb+/4/PjA9XpVpUYYhrpIC7zIvKrdDnmRa492+TtJzqcTTgIS3W433O/3PzweD3x9f+MHx63wv7UxAZQAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"4-2\"\n        title=\"4-2\"\n        src=\"/static/72fd94e80589c7fed1a9ccbbd05021e0/e9beb/2.png\"\n        srcset=\"/static/72fd94e80589c7fed1a9ccbbd05021e0/5a46d/2.png 300w,\n/static/72fd94e80589c7fed1a9ccbbd05021e0/0a47e/2.png 600w,\n/static/72fd94e80589c7fed1a9ccbbd05021e0/e9beb/2.png 730w\"\n        sizes=\"(max-width: 730px) 100vw, 730px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n    </span></p>\n<p>It is possible to check if padding is added or not by checking the size of each file.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 832px;\"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 43.66666666666667%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAJCAYAAAAywQxIAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAB2ElEQVQozzVSy3LaQBDk/5Mql102xmCsRIBeIGkl7a5eCMQjuZIDF/iZdo+oHKZUu5rp7uneUbReQ2UZMlaaJojCEPP5F/I8x+FwwGm3Q8W7OPCx3mygjcXpeERpLXsKZCrDdtvxXGK/7zEKgwBJkqCqSlaFMAwwmXwg4XDEe/P8jP7pCZufP+DzrAs9EAecC6MIvuej0JrACttuh5HneQOzSlOkHPC8FV7fxojjGLoscXRdlCsPKYGXBCioqus65NxIhCScS0iQ8f5y+fdQKMPGGLRtw6YYk4/pwBizmukUxnGQv71iwdU1B5u2xYZWiU1il1ICqgh4wSiOuRZ92ZG1rmVlevjlDApsU+Pw20XlLqBeXuCT2LL3v0JFQilrDcELXK9XKiSAXDZNw6oHhbPZnAP5sPJ5sUSzXEKPx1hRVdu0OJ1OMPTNMggJr65r+mgegJKqSJdA+r4fGh3nFyqCCWA7+0RP78z7OxTVSZ8QW1pkmbQRdfkj6fv9/lCYkaXksNEFAt/HdPpJ83N0JPjLcydh0EN/8NqSeD+sLupUplAUOaq6we12w2jwgD/lzZ3PZz6LHC49q6kkEeVM/A+T1gTUtKWjEglQF8Xjy4200QxqixsVfgMWeylUioq0FgAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"4-3\"\n        title=\"4-3\"\n        src=\"/static/824c05a6e1cf7c02b1d61e280ac0e5c8/ef6b9/3.png\"\n        srcset=\"/static/824c05a6e1cf7c02b1d61e280ac0e5c8/5a46d/3.png 300w,\n/static/824c05a6e1cf7c02b1d61e280ac0e5c8/0a47e/3.png 600w,\n/static/824c05a6e1cf7c02b1d61e280ac0e5c8/ef6b9/3.png 832w\"\n        sizes=\"(max-width: 832px) 100vw, 832px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n    </span></p>\n<p>The size of the ciphertext encrypted by ECB and CBC mode is different with the original plaintext file. This result shows that ECB and CBC encryption mode has paddings, while CFB and OFB mode does not. It is because in ECB and CBC mode, the plaintext is XORed with the output of a block cipher to make a ciphertext, which makes the ciphertext match the block size of a cipher. Therefore, no padding is needed to make the ciphertext to match the block size of a cipher.</p>\n<h3 id=\"2-checking-the-padding-of-files\" style=\"position:relative;\"><a href=\"#2-checking-the-padding-of-files\" aria-label=\"2 checking the padding of files permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>2-Checking the Padding of Files</h3>\n<p>The objective of this task is to find out how padding is added to files by encrypting and decrypting files.</p>\n<p>To find out, I prepared files of length 5, 10, and 16 bytes.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 674px;\"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 10.666666666666668%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAACCAYAAABYBvyLAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAAjElEQVQI1x2MuwqDMAAA/f/NTYoZrBFijPWFoCgGrFVBO7rpt1ylw8Hdco4Mn2RZTlEUlDdBEJAXJdu2Ya2lqirqumZZV+wwYNKUpmno+47h7n3/chwH53lyXRfOw/NQShHHCilDXNe9XbPMM23borXGJAnvaaLvOmQUIXwfIQR59sKY9D8ex5HPvPADiTt8zhX361kAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"4-4\"\n        title=\"4-4\"\n        src=\"/static/f2629dba068d2de51e231e2d64b3e036/fdaf8/4.png\"\n        srcset=\"/static/f2629dba068d2de51e231e2d64b3e036/5a46d/4.png 300w,\n/static/f2629dba068d2de51e231e2d64b3e036/0a47e/4.png 600w,\n/static/f2629dba068d2de51e231e2d64b3e036/fdaf8/4.png 674w\"\n        sizes=\"(max-width: 674px) 100vw, 674px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n    </span></p>\n<p>Then, I encrypted these files with 128-bit AES with CBC mode.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 1166px;\"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 45.33333333333333%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAJCAYAAAAywQxIAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAByElEQVQozz1SyXbiQAz0/58ypxmTGLCNFzA2i/fdQNgSHgcGHtvjW2qkzsBBT1J3q1QqtdTTdQwGA9j9PmzbRqv1LnJ/OoWqaVDVLrrdLnSKTdOCaRgwTBPj8RhpmiIMQ3ieB4dqRqMxJH6s0eNerweLChi4KEvUdY08z1FSXFXVy1cV+xqr1QqbzUb4z88lFosF1usNpE6nDZ1YMqimqpDllmA4mUxEE3Gu6RTrMC1iaBp07yAIAiRxDN/34bouhsOhYC0pHx8/IxGoSoAditM0Q9M0iKkgSWLhMxqvKAphzLaZNYLdcrnEfD7HbDYTseQSsud6Qj/uZP7Xxw98OJQzW2bkOA5GdO66Q7ikWZZlApyb8TRcE5CekvznNxRFEaIz23eynB7OmxoJLYaZ1qQd65llObbbLfb7PY7HIw6Hg7C/ZJyfTidIU0KPwkgUlWUBy7IRxAlqYpz9ekMaRYJNRN2ZAY/39f2N8/mMy+Xysuv1itvt9jMyU+Yv4PtTGD0DUZKiplHzdhsZAeZFjph8SMbb3O12L5CnPXOpT0xYJ1EQBjS2gtFkipQ2nMgyIho7zVKxzQmd83da03d5Mrrf7y97PB74B5yKNH4HhhQCAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"4-5\"\n        title=\"4-5\"\n        src=\"/static/0adc3248377d056a238f03edd7ead845/077b7/5.png\"\n        srcset=\"/static/0adc3248377d056a238f03edd7ead845/5a46d/5.png 300w,\n/static/0adc3248377d056a238f03edd7ead845/0a47e/5.png 600w,\n/static/0adc3248377d056a238f03edd7ead845/077b7/5.png 1166w\"\n        sizes=\"(max-width: 1166px) 100vw, 1166px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n    </span></p>\n<p>We can see that the size of the encrypted file of a 5 byte and a 10 byte file is 16 bytes. This is because padding is added during encryption, which makes the size a multiple of 16 bytes (128 bits, the block size of AES-128-CBC encryption). We can also see that the size of the encrypted file of a 16 byte file is 32 bytes, which means a padding of full block(16 bytes) was added.</p>\n<p>To check each file’s padding, I decrypted each file with the <code class=\"language-text\">-nopad</code> option, which does not remove padded data during encryption.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 732px;\"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 36.333333333333336%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAHCAYAAAAIy204AAAACXBIWXMAAA7DAAAOwwHHb6hkAAABW0lEQVQozz2R2XKCQBBF+f8PMC8aEGVfpJQZUBBcQKOllg9qLPVfbqbbJA+nZr99b4/m+z6CIGDiKEav20Ucx5BCwLJsDAYDxrZtvuN5Hs+FOs/zHCJNMR6PQTpCSGhmvw/DMGCaJj90HIcFbcuCzHLMZjNmOp2iLEumrmtsNhs0TYPVaoX1eo3lcontdkuCBnRdVxgs+NHpKGcWXNfBcGgphgztkQvP9eA6LrsjJpMJRqOEz2SWQfN9FUG54ssqDkFxkiTBfF6hqioeF4sF2rZlNzQnN/v9ntntduz4cDhA81yXRcIwVJVGHDWKIu5XGEZc6A9qRRi875ForYplmUSq+kh7RVFA0z97qod9bjRFpnhSSo5SlHN8KSfn8xnH45HHy+WC6/WK+/3O3G63f2itSZFCyFw1ulIiKTedPqBpWq5O61bFoain0wnfvyL0+PF44Pl8Mq/Xi/kBFN63gcLNhkUAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"4-6\"\n        title=\"4-6\"\n        src=\"/static/ac4d4071d743d00c9fa0150b938697c8/d0cc0/6.png\"\n        srcset=\"/static/ac4d4071d743d00c9fa0150b938697c8/5a46d/6.png 300w,\n/static/ac4d4071d743d00c9fa0150b938697c8/0a47e/6.png 600w,\n/static/ac4d4071d743d00c9fa0150b938697c8/d0cc0/6.png 732w\"\n        sizes=\"(max-width: 732px) 100vw, 732px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n    </span></p>\n<p>Then, I displayed each file in hex format.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 857px;\"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 49%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAKCAYAAAC0VX7mAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAB0UlEQVQoz02SWZOaUBCF+f9vic7EcZuJy9PE0pJFQBSQHQUV1/LPnHQ3MyYPXQ236p7+Tp+rNBsNdLsdzKZTjMdjTCYT6LqOxWIB0zRhUA/DEKvVClEYYb/f43g84nQ6yTefb7dbnM9nKeXX6wv6vZ5cVlWVhEys1y4cx4Ft21gul/B9X86CIJDLu90OZVlKJUkiwpfLpRZ8aTbR63WFakqUmqaJkDqfYzqbYU5DLBrG3TQXcD0XruvC8zzkJM5D9mUtyNRE+Ip+vy9CbFel7jgrGcBnmqYT3VpI83wrdr8tHw4HIWTRPM9xv9+hdDtt/P74ECoWsCyLCDwR4G/LsrHZ+ETmid2qqqTYHvcsy0gsE9uPxwPKW6uF4WAgyzUMQ4TZkm1bXzt04JMYC/M5EyVxLP1ApGmaIoqif4Kddhvj0UhC0HVDehCE/4XiIIojsR1HsVzk4kDYNlOz3bIsZAVK+62F0Wgo0+tEN8+9cLq8/CxL5enUlo9P29frtU67KGRIUZRflocDeXefn38kBBY3KBR+RkztEh13jxJmGt5bmmYiyv9pmkjngUrj5w+8U8ox7YV3wcV0Mdlk0m9LvKskiaWzIFdVnZ4Pmmlvtxv+AnoniJKFSnIpAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"4-7\"\n        title=\"4-7\"\n        src=\"/static/8f094f832758b7fb8253ee31ffcec762/3cd52/7.png\"\n        srcset=\"/static/8f094f832758b7fb8253ee31ffcec762/5a46d/7.png 300w,\n/static/8f094f832758b7fb8253ee31ffcec762/0a47e/7.png 600w,\n/static/8f094f832758b7fb8253ee31ffcec762/3cd52/7.png 857w\"\n        sizes=\"(max-width: 857px) 100vw, 857px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n    </span></p>\n<p>We can see that in <code class=\"language-text\">p1.txt</code> has padded eleven 0x0b to <code class=\"language-text\">f1.txt</code>. <code class=\"language-text\">p2.txt</code> has padded six <code class=\"language-text\">0x06</code> to <code class=\"language-text\">f2.txt</code> .</p>\n<p>This is because the padding normaly used in block ciphers is PKCS#5 padding, which adds <code class=\"language-text\">B-k</code> bytes of value <code class=\"language-text\">B-K</code> , where <code class=\"language-text\">B</code> is the block size and <code class=\"language-text\">K</code> is the size of the last block. In the examples , B=16 and K=5 for the first example and K=10 for the second example.</p>\n<p>We can also see that <code class=\"language-text\">p3.txt</code> has padded sixteen 0x10 to <code class=\"language-text\">f3.txt</code>.This is because in PKCS#5 padding, when the size is a multiple of the block size, a padding of a full block is added to prevent confusion during decryption. If there is no padding, the decryption software might make a mistake while decrypting a file which the size of the plaintext is a multiple of the block size and its last bytes are all the same value.</p>\n<h2 id=\"task-6-initial-vector-iv-and-common-mistakes\" style=\"position:relative;\"><a href=\"#task-6-initial-vector-iv-and-common-mistakes\" aria-label=\"task 6 initial vector iv and common mistakes permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Task 6: Initial Vector (IV) and Common Mistakes</h2>\n<h3 id=\"1--uniqueness-of-iv\" style=\"position:relative;\"><a href=\"#1--uniqueness-of-iv\" aria-label=\"1  uniqueness of iv permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>1- Uniqueness of IV</h3>\n<p>The objective of this task is to show that no IV may be reused under the same key.</p>\n<p>For this task, I prepared a plaintext file <code class=\"language-text\">plain.txt</code>and encrypted it using aes-128-cbc with Key 0x00112233445566778899AABBCCDDEEFF and IV 0x0102030405060708.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 1200px;\"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 5.333333333333334%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAABCAYAAADeko4lAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAATElEQVQI1xXJMQ6AIBAAQf//Ba9HkWBFaAgdR8KR8KQVqynmEDlx7kJECE/A+5sYX3LO20hKiVIKtVZaa4xhmBlrLeac9N5RVXTf/x+17j93crXM0AAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"6-1\"\n        title=\"6-1\"\n        src=\"/static/7e46af2a02708d28da2d2b7250f9f6de/c1b63/1.png\"\n        srcset=\"/static/7e46af2a02708d28da2d2b7250f9f6de/5a46d/1.png 300w,\n/static/7e46af2a02708d28da2d2b7250f9f6de/0a47e/1.png 600w,\n/static/7e46af2a02708d28da2d2b7250f9f6de/c1b63/1.png 1200w,\n/static/7e46af2a02708d28da2d2b7250f9f6de/d43b4/1.png 1202w\"\n        sizes=\"(max-width: 1200px) 100vw, 1200px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n    </span></p>\n<p>Then, Encrypt <code class=\"language-text\">plain.txt</code> again using the same IV , and using a different IV (0x8070605040302010).</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 1200px;\"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 7.333333333333333%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAABCAYAAADeko4lAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAAR0lEQVQI1x3GMQrAIAxA0d7/BpbsRpzsEFEcFJfc6lscHrznDQFVRUSIUUlJyTnTWrvMjLXWNcZg733v7sw56b1jtVJ/pXwcpgE+VzZ5W2sAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"6-2\"\n        title=\"6-2\"\n        src=\"/static/81e8219859067766dcc6c357bb36e21f/c1b63/2.png\"\n        srcset=\"/static/81e8219859067766dcc6c357bb36e21f/5a46d/2.png 300w,\n/static/81e8219859067766dcc6c357bb36e21f/0a47e/2.png 600w,\n/static/81e8219859067766dcc6c357bb36e21f/c1b63/2.png 1200w,\n/static/81e8219859067766dcc6c357bb36e21f/5c744/2.png 1206w\"\n        sizes=\"(max-width: 1200px) 100vw, 1200px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n    </span></p>\n<p>So, <code class=\"language-text\">c1</code> and <code class=\"language-text\">c2</code> are ciphertexts that have encrypted the same file with the same key and same IV. However, <code class=\"language-text\">c1</code> and <code class=\"language-text\">c3</code> are ciphertexts that have encrypted the same file with the same key and different IV.</p>\n<p>Use the <code class=\"language-text\">diff</code> command to find out if the files are identical or not.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 539px;\"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 25.333333333333336%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAFCAYAAABFA8wzAAAACXBIWXMAAA7DAAAOwwHHb6hkAAABEklEQVQY0z2QW3KDMAxFs/8lkGITnuZhB4KBYhMgwMCyblV3ph8e+UM6Olc3zgI8HgHSNINSEnmeIwxDMMbQ9wOWZcHQd5BKQVYSrW4xTW9YY9A0jeuZpgltqzEM37gxn4Mzn0AFilwgihNaEILzwA2o5xM1vYQWpkmMcTQ4zxPHsTvQ+z1j2zbM84x1/fwBA86RZsIB4zh2sPv9jpqAWmu8mhpFWVICRX0pWXa0ROHVtjDGOthIxtZa3KIwRkQR3YCsIARZRhFBOQ1qMhrRUS2rCnVdI0kSqmQuJXTXO8t1XQls3Cn+DYXIITKKG0bwfQbP8xwgzTKURYng8XvXLxg74bouinw4s2VZse+7+38o+g8l6zDM1zVLQQAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"6-3\"\n        title=\"6-3\"\n        src=\"/static/e9279e6feaccd625319aa753622573fd/10f9a/3.png\"\n        srcset=\"/static/e9279e6feaccd625319aa753622573fd/5a46d/3.png 300w,\n/static/e9279e6feaccd625319aa753622573fd/10f9a/3.png 539w\"\n        sizes=\"(max-width: 539px) 100vw, 539px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n    </span></p>\n<p>We can also display each file in hex format to verify.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 861px;\"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 23%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAFCAYAAABFA8wzAAAACXBIWXMAAA7DAAAOwwHHb6hkAAABDElEQVQY0z1QSY6DQAzk/zcOQbnkPmEJYoemaSARewhCkPfU2D3SHKyyLLk243a7IQgCOI6Dn7sNpRSKokCWZfA8D7JSqGuFJEnQ9T3WdcU8zxr3fdd4HAfO88T3+4VxvV4RRhGKPEdMT03ToCxLiFIgp5tStRbh2+v1Qk+k4zj+kzIuy6L3z+cDw7pc4Ps+Ho8HXHLEJOwmIhHXcclpjpzchmGIqqrQtq2eruswTROez6cWWN9vvGkM0zThuC48Gtt29FOapprQtm0kaQZBFQREyG6ZZBgGmlETsLNt2zQpo2FZFuI4pt5yCCEgKRp3yDs7lVKiFH/xpax07LZt0JIzjssVLIQN3RYS+AUQ70C7MdPXiQAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"6-4\"\n        title=\"6-4\"\n        src=\"/static/b4a9faff7c83289c27c405772ca4882b/e35ec/4.png\"\n        srcset=\"/static/b4a9faff7c83289c27c405772ca4882b/5a46d/4.png 300w,\n/static/b4a9faff7c83289c27c405772ca4882b/0a47e/4.png 600w,\n/static/b4a9faff7c83289c27c405772ca4882b/e35ec/4.png 861w\"\n        sizes=\"(max-width: 861px) 100vw, 861px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n    </span></p>\n<p>The result shows that <code class=\"language-text\">c1</code> and <code class=\"language-text\">c2</code> are identical, while <code class=\"language-text\">c1</code> and <code class=\"language-text\">c3</code> are not.</p>\n<p>This means that when the same plaintext is encrypted with the same key and IV, the output ciphertext is always the same. Therefore, A different IV should be used every time a same plaintext is encrypted to prevent known plaintext attack. If the same IV is used, if an attacker knows the plaintext of a particular ciphertext, the plaintext can be known whenever the ciphertext appears again. To prevent this, a different IV should be used every time so that the ciphertext of the same plaintext changes every time.</p>\n<h3 id=\"2--common-mistake-use-the-same-iv\" style=\"position:relative;\"><a href=\"#2--common-mistake-use-the-same-iv\" aria-label=\"2  common mistake use the same iv permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>2- Common Mistake: Use the Same IV.</h3>\n<p>The objective of this task is to show that even though a plaintext does not repeat, using the same IV is not safe.</p>\n<p>This picture is how Output Feedback Mode works.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 594px;\"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 42%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAICAYAAAD5nd/tAAAACXBIWXMAAA7DAAAOwwHHb6hkAAABI0lEQVQoz1WS6wqCQBCFff9nC/wREmqalkre8pKlljrxDWzUwGH1zO3szFrv91u2bZO+7yWKIjmfz5KmqQzDIK/XS+Z51nNZFo1b1/WPJx8OH98WPxgBl8tF4jiW2+2mBadpUtzvd+WIAc/nU89xHKVpGmnbVhvSwCIRdTiu16uqJACORM6qquR4PGpDfI/HQ0weOb7vS1EUyn8VUv1wOIht25JlmTqN1XWtPH4aczVjYRjKbrfTZl+FkEmSiOd54rqudF2nMynLUoIgUJ/jODoOkgDfAP9+v9dGiLNQwg9FAPPCzKJQB0cMhcy8mSnXx0ce9rcU7HQ6qUICf43FMCfm+xuP8SJQz21UIdsBv88BEADyPFeQyAJQBk9T81TYtqnxAbYgYvyjMLn+AAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"6-5\"\n        title=\"6-5\"\n        src=\"/static/425f9f43e79b20df4d7de547f233584c/5fd3e/5.png\"\n        srcset=\"/static/425f9f43e79b20df4d7de547f233584c/5a46d/5.png 300w,\n/static/425f9f43e79b20df4d7de547f233584c/5fd3e/5.png 594w\"\n        sizes=\"(max-width: 594px) 100vw, 594px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n    </span></p>\n<p>In OFB mode, the plaintext is XORed to the Output Stream to make a Ciphertext.</p>\n<p>This can be expressed in the following way.</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">Ciphertext = Plaintext  XOR F(IV,Key)</code></pre></div>\n<p>(F is the Encryption Function)</p>\n<p>In the task, for the given <code class=\"language-text\">C1</code>, <code class=\"language-text\">C2</code>, <code class=\"language-text\">P1</code> and unknown <code class=\"language-text\">P2</code>, the following is true.</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">C1 = P1 XOR F( IV , key )\nC2 = P2 XOR F( IV , key )</code></pre></div>\n<p>By the mathematical property of XOR, the following can be derived.</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">C1 XOR C2 = (P1 XOR F( IV , key )) XOR (P2 XOR F( IV , key ))\n\t\t  = P1 XOR F( IV , key ) XOR P2 XOR F( IV , key )\n\t\t  = P1 XOR P2 XOR F( IV , key ) XOR F( IV , key )\n\t\t  = P1 XOR P2\nP1 XOR C1 XOR C2 = P1 XOR P1 XOR P2 = P2</code></pre></div>\n<p>Therefore, It is able to find <code class=\"language-text\">P2</code> by calculating <code class=\"language-text\">P1</code> XOR <code class=\"language-text\">P2</code> XOR <code class=\"language-text\">P3</code>.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 398px;\"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 6.666666666666667%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAABCAYAAADeko4lAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAAUElEQVQI1w3LOw6AIBBAQe9/BghURIHS9RNjAKHCihM97WcmoxTLMuOcw3vPKkKMgRg81li01uzHSW2NMQZv74TfpZy5rpv6FOQ/JSdk2/gAl3g+AmmMhkYAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"6-6\"\n        title=\"6-6\"\n        src=\"/static/cf79aa37e8b86bfdba5d90803971c6a8/692d4/6.png\"\n        srcset=\"/static/cf79aa37e8b86bfdba5d90803971c6a8/5a46d/6.png 300w,\n/static/cf79aa37e8b86bfdba5d90803971c6a8/692d4/6.png 398w\"\n        sizes=\"(max-width: 398px) 100vw, 398px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n    </span></p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 817px;\"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 71.66666666666667%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAOCAYAAAAvxDzwAAAACXBIWXMAAA7DAAAOwwHHb6hkAAABtUlEQVQ4y3WS607CQBCF+/5PYGJIEBMuApqYAIVQpa3QbbmV+536JseZJVO3FX+c7P6Y+fbMmbUeHwqoN5poNt7Qfu+gWqmiXm+g2+3C8zyMowhhGCKiczKZYDabYT6fY7FYaC2XS6xWq1RWoVRCqddDjZrf7DaKxSIqlQrK5TI6to1oPEYQBFBKYUx3gcZxrGEsE2w91V7w3GqhTI5qdDabr/hwurAJ1nd66A+/0KY7O2anpkuG5l1atuvj0x3A6ffhOA5839fjcXMYKu2MHcrY7FKAMroA1+s1LM/7okJqpmIBMUR0A91gkqMJMt1p4ICASgXahWQlIFN5oJlhZimuATSd/bqLMrD/8mN3m82GRvaHf4CmK87M3G4exiCB7XY7WKMg0n9NqexoAmFNp9N0CfecbbdbDdvv97CGQUiF/HKsHXAzi+/5bbIYwm4YwmLI4XDQOh6PBBwpDYzjRfpJ2cW9PyYghohM2Ol04pHDdBQTkt+ewHg0AYgYdD6fb0AVTghCsEwuqzRsCdzMyYRcLhdcr1ckSaJlua6HUTDKfBdulIwEYo4oMH6I70nyTY8cdP0Pv0q2mjCMlGIAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"6-7\"\n        title=\"6-7\"\n        src=\"/static/2e2483b6a3c665ffcc1d77bb37a669db/98314/7.png\"\n        srcset=\"/static/2e2483b6a3c665ffcc1d77bb37a669db/5a46d/7.png 300w,\n/static/2e2483b6a3c665ffcc1d77bb37a669db/0a47e/7.png 600w,\n/static/2e2483b6a3c665ffcc1d77bb37a669db/98314/7.png 817w\"\n        sizes=\"(max-width: 817px) 100vw, 817px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n    </span></p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 819px;\"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 30%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAGCAYAAADDl76dAAAACXBIWXMAAA7DAAAOwwHHb6hkAAABQUlEQVQY0zWRWZKCQBBEuf8dRgfZGxyVXUFBXMCFMAL0w+UuOdWlflRUd0TXy8xqZTj4gaqqMAwDw8EAw18VYRhiMpnANE14nofZzOce+D7G4zFWqxXK9Rp5nqNtW2y3WzSHA67XKxRd02BZNmzbgvUBTKdTgsx42LZtCEewgOe6dHcQRRHSJEEUxywuBdr2jKZpoJiGDl03CGriC/fJiQQK4TJUnr8irushI2dlWTKoIqfH4xGXywVd30FxyIFLypZlcf2RE6kqQRoJSDF5FkKwe1kJuVssFkjncxRFgf2+Rt/3uN1uUITjYDTS+KGM53rvHSXJO06WZTRUIo4jjp2kKXa7HU6nE6rNBlVVoa5r3uOZ9kmRDQRBwC7y5ZIgEasvKZbsZVlwvCAI+QO6rmOHMuLr9cL9fsfj8eB6Pp/4B7IaeG+ByR2kAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"6-8\"\n        title=\"6-8\"\n        src=\"/static/266c3d8a45b518b00d21c2d9ff895307/97655/8.png\"\n        srcset=\"/static/266c3d8a45b518b00d21c2d9ff895307/5a46d/8.png 300w,\n/static/266c3d8a45b518b00d21c2d9ff895307/0a47e/8.png 600w,\n/static/266c3d8a45b518b00d21c2d9ff895307/97655/8.png 819w\"\n        sizes=\"(max-width: 819px) 100vw, 819px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n    </span></p>\n<p>The plaintext <code class=\"language-text\">P2</code>, “Order: Launch a missile!” has been decrypted without knowing the key and IV of encryption.</p>\n<p>Therefore, when OFB mode is used, if IV is not changed, any ciphertext can be encrypted by the attacker who knows one pair of plaintext and ciphertext.</p>\n<p>In CFB mode, only the first block is revealed by the same way because the plaintext is XORed to the output before it is used for the next input of the block cipher encryption function.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 587px;\"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 41.66666666666667%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAICAYAAAD5nd/tAAAACXBIWXMAAA7DAAAOwwHHb6hkAAABD0lEQVQoz42R546DQAyEef8XpCmihRp6RxSfPp+I0P06S86SsXc84zWu65I7mqaRIAgkDEPNuq5l2zZZ11X2fZdlWbQPjO+/OGHwA0iO4yhRFInrupKmqf4/jkMvJkmiuOd50rbt905RFPJ6vbTW9/0v4TAMkmWZKkSZaZoSx7GUZak4Sjkty1LCqqokz3P5fD7aAxnZdZ0Y8zxrEySoAEQdNnzfF9u2tc506vRTdxznSwI5a1DLyMYS1lACCQTv91umaZLzPNUBqwDHAST3KnACzu5xaMgjeCCm04AVyEhw7IGjEhFgJEMZAjGujLvwfG2KXOTEFvvjEg+AUiyiiG8GPsO4ld3nk/g/8RRE/gBmk2I/KScrqQAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"6-9\"\n        title=\"6-9\"\n        src=\"/static/847693704cd01117d13a288e778f4e36/d72eb/9.png\"\n        srcset=\"/static/847693704cd01117d13a288e778f4e36/5a46d/9.png 300w,\n/static/847693704cd01117d13a288e778f4e36/d72eb/9.png 587w\"\n        sizes=\"(max-width: 587px) 100vw, 587px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n    </span></p>\n<h3 id=\"3-common-mistake-use-a-predictable-iv\" style=\"position:relative;\"><a href=\"#3-common-mistake-use-a-predictable-iv\" aria-label=\"3 common mistake use a predictable iv permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>3. Common Mistake: Use a Predictable IV</h3>\n<p>The objective of this task is to show that attackers can break encryption if IVs are predictable.</p>\n<p>A chosen plaintext attack against CBC mode will be used.</p>\n<p>This picture is how Cipher Block Chaning Mode works.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 608px;\"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 40.33333333333333%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAICAYAAAD5nd/tAAAACXBIWXMAAA7DAAAOwwHHb6hkAAABFklEQVQoz22RiY6CUAxF+f+vMyFCXAIIsohsElRAQs3ppGacTJNHebe3232O/LG2beV0OknXdbKuq2L4uq4VJ2441jTNF+7cbjdJ01Su16skSSKbzUY8z9P/aZqUNAyDhGEo+/1ek5/Pp+L4KIpkt9t9+E5VVQpCPJ/P0ve9FsfGcdQDEX+5XP7Fi6L4TOzwWZZFR+YEQSCu60ocx7oOG9DkeDwqTnPDmfxwOMh2u1U/z/NPQcanKN0gk5Rlmer4er2+cOShMXwmRFu4eLgOxUxkCCT5vq8SkITRmTsaoiV3GwTc+KqhBayovSba3u93XffxeEie54oTB7cYx7CPhlYUQ5eyLPVhODyEedYm2eKsz0v/rvEGPi9hNFaIJlMAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"6-9\"\n        title=\"6-9\"\n        src=\"/static/ab004afc2ce67eeb6256e6651e480a43/18872/10.png\"\n        srcset=\"/static/ab004afc2ce67eeb6256e6651e480a43/5a46d/10.png 300w,\n/static/ab004afc2ce67eeb6256e6651e480a43/0a47e/10.png 600w,\n/static/ab004afc2ce67eeb6256e6651e480a43/18872/10.png 608w\"\n        sizes=\"(max-width: 608px) 100vw, 608px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n    </span></p>\n<p>The IV is XORed to the plaintext before it is encrypted.</p>\n<p>This can be expressed in the following way.</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">Ciphertext = F(IV XOR Plaintext , Key)</code></pre></div>\n<p>(F is the Encryption Function)</p>\n<p>In the task, for ciphertext <code class=\"language-text\">C1</code>,<code class=\"language-text\">C2</code> and plaintext <code class=\"language-text\">p1</code>,<code class=\"language-text\">p2</code>, the following is true.</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">C1 = F( IV1 XOR P1 , key )\nC2 = F( IV2 XOR P2 , key )</code></pre></div>\n<p>Since Eve can choose any message <code class=\"language-text\">P2</code> and knows <code class=\"language-text\">IV1</code> and <code class=\"language-text\">IV2</code>, suppose that Eve chose <code class=\"language-text\">IV2 XOR IV1 XOR 'Yes'</code> as <code class=\"language-text\">P2</code></p>\n<p>Then, the following can be derieved.</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">C2 = F( IV2 XOR P2 , key )\n   = F(IV2 XOR IV2 XOR IV1 XOR 'Yes' , key)\n   =F( IV1 XOR 'Yes' , key)</code></pre></div>\n<p>If <code class=\"language-text\">p1</code> = Yes, then <code class=\"language-text\">C1 = F( IV1 XOR 'Yes' , key )</code> and <code class=\"language-text\">C1</code>=<code class=\"language-text\">C2</code>.</p>\n<p>In the same way, If Eve choses <code class=\"language-text\">IV2 XOR IV1 XOR 'No'</code> as <code class=\"language-text\">P2</code>,</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">C2 = F( IV2 XOR P2 , key )\n   = F(IV2 XOR IV2 XOR IV1 XOR 'No' , key)\n   =F( IV1 XOR 'No' , key)</code></pre></div>\n<p>If <code class=\"language-text\">p1</code> = No, then <code class=\"language-text\">C1 = F( IV1 XOR 'No' , key )</code> and <code class=\"language-text\">C1</code>=<code class=\"language-text\">C2</code>.</p>\n<p>Therefore, Eve can find out <code class=\"language-text\">p1</code> by asking Bob to encrypt <code class=\"language-text\">P2= IV2 XOR IV1 XOR 'Yes'</code> and <code class=\"language-text\">P2= IV2 XOR IV1 XOR 'No'</code> .</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 834px;\"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 77%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAPCAYAAADkmO9VAAAACXBIWXMAAA7DAAAOwwHHb6hkAAACt0lEQVQ4y01UV3PaYBDU/39JZvLkSeTQi7DAVANCgEURoILpweBC/sjm9iCZPNyc+Mre3t5+GKaZRKVSwfPzEO12G92ug9Vqhel0isFggDAMMZ/PEUURwihGEAQ4n8/4+PjA+/u7Br8/Pz81DPM+iU6ng9lshtFohPF4gv1+jzhe6uX1ZoNlHGO9XmO5XGK73Srg29ubghHkcrng8vtyBczmiqjVqmg1m6hWa6g3GgI6Rr/fV8aDwRAvLy8acUyGC2EaKfNIgusbKcaudrs9jEQijVQyiUyaOaXZfniAZVnIZDLo9Vwcj0ccDgdltxHG7GC/2wnATr+5x3wS5sa9tJxKpZDLZmGa90gKKJnZdlkBbbuiWg4luF62bRQKeRSLFtpPT9oJo9dzVBKjUCjJgQJKwiidziCbzelmrV5HPp9Do9FUbRme56neDZGFIKFoTJ0pBXU+vr7CsCwbrVYLExkGmfAgB3St2tOWCcSpjycTZRHJ5cViAd/3MZlMNfP3ViRQhtVqVQDHYp1nBeIlHiIQwcmCtmHWYch3/B9odBvSer2BkctbyoRe63a76keyGY1k0q4L1+0rCxaMbq0RYD5faLGZ3FswBJxD0qFwomTmOA46AsrqvhweDoeyPtDfZOuJjmRyOPySy1ucTifx41mnTA++UsNi8UE0bCp1FV8u0odkSAYEY+Z+EIQIhAnZsQvurVZrtRKNH0gxwzQTKJVKyoBADH/m6wWCUAoCMpPdFWT1L/76koAM48vXb7i7u0O5XBbrlMR3tujmql0eHx9lvQJHNG6KVegGyuD71wIED2+vheDqw+8/fqqGjmhHfzXlCT6JYeviQwLQdxwaZeEfhyvfai8pymFN/Ws37IzDMhJJeQ1l+/oaxDZkp/aRTDaeR1N7OjSuU2dKodIIU75r/wbKp/kH/yzXCJpXeycAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"4-11\"\n        title=\"4-11\"\n        src=\"/static/dcd769e879537f0b7904e97037ca7f5b/5d72a/11.png\"\n        srcset=\"/static/dcd769e879537f0b7904e97037ca7f5b/5a46d/11.png 300w,\n/static/dcd769e879537f0b7904e97037ca7f5b/0a47e/11.png 600w,\n/static/dcd769e879537f0b7904e97037ca7f5b/5d72a/11.png 834w\"\n        sizes=\"(max-width: 834px) 100vw, 834px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n    </span></p>\n<p>By the following command, <code class=\"language-text\">P2= IV2 XOR IV1 XOR 'Yes'</code> and <code class=\"language-text\">P2= IV2 XOR IV1 XOR 'No'</code>has been encrypted. The result shows that the encryption result of <code class=\"language-text\">P2= IV2 XOR IV1 XOR 'Yes'</code> equals <code class=\"language-text\">C1</code>, which means that Eve can find out <code class=\"language-text\">P1</code>=Yes. Beware of the Padding added throughout the proccess.</p>\n<p>The result can be verified by decrypting <code class=\"language-text\">C1</code>.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 818px;\"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 13.666666666666666%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAADCAYAAACTWi8uAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAAuUlEQVQI1z2Oy4qDQBRE/f9/yEDPIkO0XUSwDRjUCCZqdDE+QBBRUb/jpGmYWRyoqsstyrpePaSUuK5EiG983ycMQ5052LZtvFKKR5oSRRGe5xl/D+/EcUxwuxEEAUmSoHyFVdc1ef6iKAqezxdVVfEuS7IsMzrPc30rGYbB0LYtXdfRNM2//qPveywhBI6j11wufJ1OONI1JaledD7/mOJf/TyOI9M0Mc8zy7Kwrqth2zb2fTccx8EHq/TGFtQYvfEAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"6-12\"\n        title=\"6-12\"\n        src=\"/static/ad5dcf1f2e848725a6bb55c3d1cd7cf4/64d87/12.png\"\n        srcset=\"/static/ad5dcf1f2e848725a6bb55c3d1cd7cf4/5a46d/12.png 300w,\n/static/ad5dcf1f2e848725a6bb55c3d1cd7cf4/0a47e/12.png 600w,\n/static/ad5dcf1f2e848725a6bb55c3d1cd7cf4/64d87/12.png 818w\"\n        sizes=\"(max-width: 818px) 100vw, 818px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n    </span></p>\n<p>To conclude, IV should be chosen unpredictably to prevent chosen plaintext attacks.</p>","frontmatter":{"title":"[SEED labs] Secret-Key Encryption Lab","date":"September 29, 2021"}}},"pageContext":{"slug":"/SEEDlabs/secretkeyencrption/","previous":{"fields":{"slug":"/PS/PS-5/"},"frontmatter":{"title":"[PS] 5. 구현 (1)"}},"next":{"fields":{"slug":"/SEEDlabs/MD5collision/"},"frontmatter":{"title":"[SEED labs] MD5 Collision Attack Lab"}}}},"staticQueryHashes":["2486386679","3128451518"]}