{"componentChunkName":"component---src-templates-blog-post-js","path":"/ML/chapter2-1/","result":{"data":{"site":{"siteMetadata":{"title":"KunheeKim.Dev","author":"[Kunhee Kim]","siteUrl":"https://kunheekimkr.github.io","comment":{"disqusShortName":"","utterances":"kunheekimkr/kunheekimkr.github.io"},"sponsor":{"buyMeACoffeeId":""}}},"markdownRemark":{"id":"87a0ea84-d907-502d-accf-05d20c229e69","excerpt":"1. 사이킷런 소개와 특징 은 가장 많이 사용되는 파이썬 머신 러닝 라이브러리입니다. 이 책은 사이킷런을 기반으로 하여 다양한 머신 러닝 모델을 작성하는 것을 가르치고 있습니다.…","html":"<h2 id=\"1-사이킷런-소개와-특징\" style=\"position:relative;\"><a href=\"#1-%EC%82%AC%EC%9D%B4%ED%82%B7%EB%9F%B0-%EC%86%8C%EA%B0%9C%EC%99%80-%ED%8A%B9%EC%A7%95\" aria-label=\"1 사이킷런 소개와 특징 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>1. 사이킷런 소개와 특징</h2>\n<p><code class=\"language-text\">사이킷런(Scikit-learn)</code>은 가장 많이 사용되는 파이썬 머신 러닝 라이브러리입니다. 이 책은 사이킷런을 기반으로 하여 다양한 머신 러닝 모델을 작성하는 것을 가르치고 있습니다.</p>\n<h2 id=\"2-첫-번째-머신러닝-만들어-보기---붓꽃-품종-예측하기\" style=\"position:relative;\"><a href=\"#2-%EC%B2%AB-%EB%B2%88%EC%A7%B8-%EB%A8%B8%EC%8B%A0%EB%9F%AC%EB%8B%9D-%EB%A7%8C%EB%93%A4%EC%96%B4-%EB%B3%B4%EA%B8%B0---%EB%B6%93%EA%BD%83-%ED%92%88%EC%A2%85-%EC%98%88%EC%B8%A1%ED%95%98%EA%B8%B0\" aria-label=\"2 첫 번째 머신러닝 만들어 보기   붓꽃 품종 예측하기 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>2. 첫 번째 머신러닝 만들어 보기 - 붓꽃 품종 예측하기</h2>\n<p>사이킷런을 통해 첫 번째로 만들어볼 머신러닝 모델은 붓꽃 꽃잎의 길이와 너비, 꽃받침의 길이와 너비 피처를 기반으로 꽃의 품종을 예측하는 분류 모델 입니다.</p>\n<p>우선 필요한 모듈들을 임포트합니다. 붓꽃 데이터 세트를 생성하고 학습 데이터와 테스트 데이터로 분리하고 의사 결정트리를 사용하기 위해 다음과 같이 필요한 모듈을 임포트합니다.</p>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token keyword\">from</span> sklearn<span class=\"token punctuation\">.</span>datasets <span class=\"token keyword\">import</span> load_iris\n<span class=\"token keyword\">from</span> sklearn<span class=\"token punctuation\">.</span>tree <span class=\"token keyword\">import</span> DecisionTreeClassifier\n<span class=\"token keyword\">from</span> sklearn<span class=\"token punctuation\">.</span>model_selection <span class=\"token keyword\">import</span> train_test_split</code></pre></div>\n<p><code class=\"language-text\">load_iris()</code> 함수를 통해 붓꽃 데이터 세트를 로딩한 후 <code class=\"language-text\">DataFrame</code> 으로 변환하여 데이터를 분석합니다.</p>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token comment\">#데이터 분석을 위해 pandas 사용</span>\n<span class=\"token keyword\">import</span> pandas <span class=\"token keyword\">as</span> pd\n\n<span class=\"token comment\">#붓꽃 데이터셋 로딩</span>\niris<span class=\"token operator\">=</span>load_iris<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n\n<span class=\"token comment\">#피쳐 데이터와 레이블 데이터를 서로 분리</span>\niris_data<span class=\"token operator\">=</span>iris<span class=\"token punctuation\">.</span>data\niris_label<span class=\"token operator\">=</span>iris<span class=\"token punctuation\">.</span>target\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">'iris target값:'</span><span class=\"token punctuation\">,</span> iris_label<span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">'iris target명:'</span><span class=\"token punctuation\">,</span> iris<span class=\"token punctuation\">.</span>target_names<span class=\"token punctuation\">)</span>\n\n<span class=\"token comment\">#붓꽃 데이터 세트를 DataFrame 으로 변환하여 분석</span>\niris_df<span class=\"token operator\">=</span>pd<span class=\"token punctuation\">.</span>DataFrame<span class=\"token punctuation\">(</span>data<span class=\"token operator\">=</span>iris_data<span class=\"token punctuation\">,</span> columns<span class=\"token operator\">=</span>iris<span class=\"token punctuation\">.</span>feature_names<span class=\"token punctuation\">)</span>\niris_df<span class=\"token punctuation\">[</span><span class=\"token string\">'label'</span><span class=\"token punctuation\">]</span><span class=\"token operator\">=</span>iris<span class=\"token punctuation\">.</span>target\niris_df<span class=\"token punctuation\">.</span>head<span class=\"token punctuation\">(</span><span class=\"token number\">3</span><span class=\"token punctuation\">)</span></code></pre></div>\n<p>[실행 결과]\n<span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 682px;\"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 41.333333333333336%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAICAYAAAD5nd/tAAAACXBIWXMAAA7DAAAOwwHHb6hkAAABMElEQVQoz02RWbaCQAxE2QeoIMigMskggvP+95SXG23P+8jpqnRSSVd73TDI+XKRaZ7l1PcynM8yavTjaLztOjvhhPF/OfqrurZo2la85nT6FGgghDi4rCorQqDTZrjLwVvtgx/LUjabjazXawuP5OF4lCzP7ST2h4MU+70FDeTAnHC3kbuLtluJosjCYxqrUrBL08+52/2aE8Xlt5mGIAjE932L1WplPAxDu+P0iqKQeVnk+X7L9X6XQX2BP14vWa5X6dWj+/Np9/iLHcvtZjXOplQX4dm2IZuM02TezSqAIJxCmhye9B4hBvCBFw3qwbku9RNkwziOJdRElmX2fDDr80z8BJOrm8a2ASdJYrW5em+577M9/NqqIASM+c5gJqc6xHHuYhUCI8gwfAc7wT/IIPNceWj/5AAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"실행결과\"\n        title=\"실행결과\"\n        src=\"/static/ce4dc2944b425394ef319c51dbf31549/160a3/1.png\"\n        srcset=\"/static/ce4dc2944b425394ef319c51dbf31549/5a46d/1.png 300w,\n/static/ce4dc2944b425394ef319c51dbf31549/0a47e/1.png 600w,\n/static/ce4dc2944b425394ef319c51dbf31549/160a3/1.png 682w\"\n        sizes=\"(max-width: 682px) 100vw, 682px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n    </span></p>\n<p>피처에는 <code class=\"language-text\">sepal length</code>, <code class=\"language-text\">sepal width</code>, <code class=\"language-text\">petal length</code>, <code class=\"language-text\">petal width</code>의 4 종류가 있으며, 레이블 데이터는 <code class=\"language-text\">setosa</code>, <code class=\"language-text\">versicolor</code>, <code class=\"language-text\">virginica</code> 의 세 가지로 각각 0, 1, 2 의 값으로 저장이 되어 있습니다.</p>\n<p>다음으로 할 일은 붓꽃 데이터 세트를 학습용 데이터와 테스트용 데이터로 분리하는 일입니다. 테스트용 데이터를 통해 학습 데이터를 이용해 학습된 모델이 얼마나 뛰어난 성능을 가지는지 평가하기 위해서입니다.\n이를 위해 <code class=\"language-text\">train_test_split()</code> 함수를 이용합니다.</p>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\">X_train<span class=\"token punctuation\">,</span> X_test<span class=\"token punctuation\">,</span> y_train<span class=\"token punctuation\">,</span> y_test <span class=\"token operator\">=</span> train_test_split<span class=\"token punctuation\">(</span>iris_data<span class=\"token punctuation\">,</span> iris_label<span class=\"token punctuation\">,</span> test_size<span class=\"token operator\">=</span><span class=\"token number\">0.2</span><span class=\"token punctuation\">,</span> random_state<span class=\"token operator\">=</span><span class=\"token number\">11</span><span class=\"token punctuation\">)</span></code></pre></div>\n<p>확보한 데이터를 바탕으로 머신러닝 분류 알고리즘 주 하나인 의사 결정 트리를 이용해 학습과 예측을 수행해 보겠습니다. 사이킷런에서 머신러닝 알고리즘을 사용할 때에는 알고리즘에 따라 객체를 생성한 뒤, 객체의 <code class=\"language-text\">fit</code> 매서드에 학습용 피처 데이터 세트와 레이블 데이터 세트를 입력하여 호출하여 학습을 진행시킵니다.</p>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token comment\">#DecisionTreeClassifier 객체 생성</span>\ndt_clf<span class=\"token operator\">=</span>DecisionTreeClassifier<span class=\"token punctuation\">(</span>random_state<span class=\"token operator\">=</span><span class=\"token number\">11</span><span class=\"token punctuation\">)</span>\n\n<span class=\"token comment\">#학습 수행</span>\ndt_clf<span class=\"token punctuation\">.</span>fit<span class=\"token punctuation\">(</span>X_train<span class=\"token punctuation\">,</span> y_train<span class=\"token punctuation\">)</span></code></pre></div>\n<p>학습된 모델을 기반으로 예측을 수행하기 위해서는 <code class=\"language-text\">predict</code> 메서드에 피처 데이터 세트를 입력해 호출하면 학습된 모델 기반에서 피처 데이터 세트에 대한 레이블 예측값을 반환합니다.</p>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\">pred<span class=\"token operator\">=</span>dt_clf<span class=\"token punctuation\">.</span>predict<span class=\"token punctuation\">(</span>X_test<span class=\"token punctuation\">)</span></code></pre></div>\n<p>예축 결과를 기반으로 의사 결정 트리의 예측 성능을 평가해 봅시다. <code class=\"language-text\">sklearn.datasets</code> 내의 모듈은 모델의 성능을 측정하는 모듈들의 모임입니다. 이중 <code class=\"language-text\">accuracy_score()</code> 를 이용하여 정확도를 측정해 보겠습니다.</p>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token keyword\">from</span> sklearn<span class=\"token punctuation\">.</span>metrics <span class=\"token keyword\">import</span> accuracy_score\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">'예측 정확도: {0:.4f}'</span><span class=\"token punctuation\">.</span><span class=\"token builtin\">format</span><span class=\"token punctuation\">(</span>accuracy_score<span class=\"token punctuation\">(</span>y_test<span class=\"token punctuation\">,</span>pred<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span></code></pre></div>\n<p>[실행 결과]</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">예측 정확도: 0.9333</code></pre></div>\n<p>실제 테스트 레이블 데이터 세트와 예측값을 비교한 결과 정확도 0.9333을 확인 할 수 있습니다.</p>\n<p>수행한 분류 예측 프로세스를 정리하면 다음과 같습니다.</p>\n<blockquote>\n<ol>\n<li>데이터 세트 분리: 데이터를 학습 데이터와 테스트 데이터로 분리합니다.</li>\n<li>모델 학습: 학습 데이터를 기반으로 ML 알고리즘을 적용해 모델을 학습시킵니다.</li>\n<li>예측 수행: 학습된 ML 모델을 이용해 테스트 데이터의 분류를 예측합니다.</li>\n<li>평가: 이렇게 예측된 결과값과 테스트 데이터의 실제 결과값을 비교해 ML 모델 성능을 평가합니다.</li>\n</ol>\n</blockquote>\n<h2 id=\"3-사이킷런의-기반-프레임워크-익히기\" style=\"position:relative;\"><a href=\"#3-%EC%82%AC%EC%9D%B4%ED%82%B7%EB%9F%B0%EC%9D%98-%EA%B8%B0%EB%B0%98-%ED%94%84%EB%A0%88%EC%9E%84%EC%9B%8C%ED%81%AC-%EC%9D%B5%ED%9E%88%EA%B8%B0\" aria-label=\"3 사이킷런의 기반 프레임워크 익히기 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>3. 사이킷런의 기반 프레임워크 익히기</h2>\n<h3 id=\"31-estiamtor-이해-및-fit-predict-메서드\" style=\"position:relative;\"><a href=\"#31-estiamtor-%EC%9D%B4%ED%95%B4-%EB%B0%8F-fit-predict-%EB%A9%94%EC%84%9C%EB%93%9C\" aria-label=\"31 estiamtor 이해 및 fit predict 메서드 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>3.1. Estiamtor 이해 및 fit(), predict() 메서드</h3>\n<p>사이킷런은 지도학습의 주요 두 축인 분류와 회귀의 다양한 알고리즘을 클래스로 구현하여 사용하기 쉽게 합니다. 분류 알고리즘을 구현한 클래스는 <code class=\"language-text\">Classifier</code>, 회귀 알고리즘을 구현한 클래스는 <code class=\"language-text\">Regressor</code>로 지칭하며, 이들을 합쳐 <code class=\"language-text\">Estimator</code> 클래스라고 부릅니다. 이들은 <code class=\"language-text\">fit()</code> 과 <code class=\"language-text\">predict()</code> 매서드를 통해 간단하게 학습과 예측을 합니다. <code class=\"language-text\">cross_val_score</code> 와 같은 평가 함수나, <code class=\"language-text\">GridSearchCV</code>와 같은 하이퍼 파라미터 튜닝을 지원하는 클래스는 이 <code class=\"language-text\">Estimator</code> 클래스를 인자로 받아 주어진 역할을 수행합니다.</p>\n<p>사이킷런은 비지도학습인 차원 축소, 클러스터링, 피처 추출 등도 클래스로 구현하여 사용하기 쉽게 합니다. 이러한 클래스는 입력 데이터의 형테에 맞춰 데이터를 변환하기 위한 사전 구조 작업인 <code class=\"language-text\">fit()</code> 과, 입력 데이터의 차원 변환, 클러스터링, 피처 추출 등 작업을 수행하는 <code class=\"language-text\">transform()</code> 매서드를 사용해 비지도학습을 쉽게 수행할 수 있도록 합니다.</p>\n<h3 id=\"32-사이킷런의-주요-모듈\" style=\"position:relative;\"><a href=\"#32-%EC%82%AC%EC%9D%B4%ED%82%B7%EB%9F%B0%EC%9D%98-%EC%A3%BC%EC%9A%94-%EB%AA%A8%EB%93%88\" aria-label=\"32 사이킷런의 주요 모듈 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>3.2. 사이킷런의 주요 모듈</h3>\n<table>\n<thead>\n<tr>\n<th>분류</th>\n<th>모듈명</th>\n<th>설명</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>예제 데이터</td>\n<td><code class=\"language-text\">sklearn.datasets</code></td>\n<td>예제 데이터세트</td>\n</tr>\n<tr>\n<td>피처 처리</td>\n<td><code class=\"language-text\">sklearn.preprocessing</code></td>\n<td>데이터 전처리에 필요한 가공 기능</td>\n</tr>\n<tr>\n<td>피처 처리</td>\n<td><code class=\"language-text\">sklearn.feature_selection</code></td>\n<td>알고리즘에 큰 영향을 미치는 피처를 우선순위대로 선택</td>\n</tr>\n<tr>\n<td>피처 처리</td>\n<td><code class=\"language-text\">sklearn.feature_extraction</code></td>\n<td>텍스트 데이터나 이미지 데이터의 벡터화된 피처 추출</td>\n</tr>\n<tr>\n<td>피처 처리 &#x26; 차원 축소</td>\n<td><code class=\"language-text\">sklearn.decomposition</code></td>\n<td>차원 축소와 관련된 알고리즘</td>\n</tr>\n<tr>\n<td>데이터 분리, 검증 &#x26; 파라미터 튜닝</td>\n<td><code class=\"language-text\">sklearn.model_selection</code></td>\n<td>교차 검증을 위한 학습용/테스트용 분리, 그리드 서치로 최적 파라미터 추출</td>\n</tr>\n<tr>\n<td>평가</td>\n<td><code class=\"language-text\">sklearn.metrics</code></td>\n<td>다양한 성능 측정 방법 제공</td>\n</tr>\n<tr>\n<td>ML 알고리즘</td>\n<td><code class=\"language-text\">sklearn.ensemble</code></td>\n<td>앙상블 알고리즘</td>\n</tr>\n<tr>\n<td>ML 알고리즘</td>\n<td><code class=\"language-text\">sklearn.linear_model</code></td>\n<td>선형 회귀, 릿지, 라쏘, 로지스틱 회귀 등 회귀 관련 알고리즘 제공</td>\n</tr>\n<tr>\n<td>ML 알고리즘</td>\n<td><code class=\"language-text\">sklearn.naive_bayes</code></td>\n<td>나이브 베이즈 알고리즘</td>\n</tr>\n<tr>\n<td>ML 알고리즘</td>\n<td><code class=\"language-text\">sklearn.neighbors</code></td>\n<td>최근접 이웃 알고리즘 알고리즘</td>\n</tr>\n<tr>\n<td>ML 알고리즘</td>\n<td><code class=\"language-text\">sklearn.svm</code></td>\n<td>서포트 벡터 머신 알고리즘</td>\n</tr>\n<tr>\n<td>ML 알고리즘</td>\n<td><code class=\"language-text\">sklearn.tree</code></td>\n<td>의사 결정 트리 알고리즘</td>\n</tr>\n<tr>\n<td>ML 알고리즘</td>\n<td><code class=\"language-text\">sklearn.cluster</code></td>\n<td>비지도 클러스터링 알고리즘</td>\n</tr>\n<tr>\n<td>유틸리티</td>\n<td><code class=\"language-text\">sklearn.pipeline</code></td>\n<td>피처 처리 등 변환과 ML 알고리즘 학습, 예측을 묶어 실행할 수 있는 유틸리티</td>\n</tr>\n</tbody>\n</table>\n<h3 id=\"33-사이킷런의-주요-모듈\" style=\"position:relative;\"><a href=\"#33-%EC%82%AC%EC%9D%B4%ED%82%B7%EB%9F%B0%EC%9D%98-%EC%A3%BC%EC%9A%94-%EB%AA%A8%EB%93%88\" aria-label=\"33 사이킷런의 주요 모듈 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>3.3. 사이킷런의 주요 모듈</h3>\n<p>(생략)</p>\n<h2 id=\"4-model-selection-모듈-소개\" style=\"position:relative;\"><a href=\"#4-model-selection-%EB%AA%A8%EB%93%88-%EC%86%8C%EA%B0%9C\" aria-label=\"4 model selection 모듈 소개 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>4. Model Selection 모듈 소개</h2>\n<h3 id=\"41-학습테스트-데이터-세트-분리---traintestsplit\" style=\"position:relative;\"><a href=\"#41-%ED%95%99%EC%8A%B5%ED%85%8C%EC%8A%A4%ED%8A%B8-%EB%8D%B0%EC%9D%B4%ED%84%B0-%EC%84%B8%ED%8A%B8-%EB%B6%84%EB%A6%AC---traintestsplit\" aria-label=\"41 학습테스트 데이터 세트 분리   traintestsplit permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>4.1. 학습/테스트 데이터 세트 분리 - train<em>test</em>split()</h3>\n<p>학습과 예측을 동일한 데이터 세트로 수행하게 되면, 이미 학습한 데이터 세트를 기반으로 예측하기 때문에 정확도가 100%가 나오는 문제가 발생합니다. 이러한 문제를 해결하기 위해 사이킷런의 <code class=\"language-text\">train_test_split()</code> 을 통해 원본 데이터 세트에서 학습 및 테스트 데이터 세트를 쉽게 분리할 수 있습니다. 파라미터로 피처 데이터 세트와 레이블 데이터 세트를 입력받습니다. 선택적으로, 테스트 데이터 세트의 비율, 데이터를 섞을지, 난수 발생 값을 사용합니다. 다음 예제를 살펴봅시다.</p>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token keyword\">from</span> sklearn<span class=\"token punctuation\">.</span>tree <span class=\"token keyword\">import</span> DecisionTreeClassifier\n<span class=\"token keyword\">from</span> sklearn<span class=\"token punctuation\">.</span>metrics <span class=\"token keyword\">import</span> accuracy_score\n<span class=\"token keyword\">from</span> sklearn<span class=\"token punctuation\">.</span>datasets <span class=\"token keyword\">import</span> load_iris\n<span class=\"token keyword\">from</span> sklearn<span class=\"token punctuation\">.</span>model_selection <span class=\"token keyword\">import</span> train_test_split\n\ndt_clf <span class=\"token operator\">=</span> DecisionTreeClassifier<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\niris_data <span class=\"token operator\">=</span> load_iris<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\nX_train<span class=\"token punctuation\">,</span> X_test<span class=\"token punctuation\">,</span> y_train<span class=\"token punctuation\">,</span> y_test <span class=\"token operator\">=</span> train_test_split<span class=\"token punctuation\">(</span>iris_data<span class=\"token punctuation\">.</span>data<span class=\"token punctuation\">,</span> iris_data<span class=\"token punctuation\">.</span>target<span class=\"token punctuation\">,</span> test_size<span class=\"token operator\">=</span><span class=\"token number\">0.3</span><span class=\"token punctuation\">,</span> random_state<span class=\"token operator\">=</span><span class=\"token number\">121</span><span class=\"token punctuation\">)</span>\n\ndt_clf<span class=\"token punctuation\">.</span>fit<span class=\"token punctuation\">(</span>X_train<span class=\"token punctuation\">,</span> y_train<span class=\"token punctuation\">)</span>\npred<span class=\"token operator\">=</span> dt_clf<span class=\"token punctuation\">.</span>predict<span class=\"token punctuation\">(</span>X_test<span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">'예측 정확도: {0:.4f}'</span><span class=\"token punctuation\">.</span><span class=\"token builtin\">format</span><span class=\"token punctuation\">(</span>accuracy_score<span class=\"token punctuation\">(</span>y_test<span class=\"token punctuation\">,</span>pred<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span></code></pre></div>\n<p>[실행결과]</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">예측 정확도: 0.9556</code></pre></div>\n<p>전체 데이터 세트의 30%를 테스트 데이터로, 70%를 학습 데이터로 분리한 뒤 학습시킨 모델의 예측 정확도를 확인할 수 있습니다.</p>\n<h3 id=\"42-교차-검증\" style=\"position:relative;\"><a href=\"#42-%EA%B5%90%EC%B0%A8-%EA%B2%80%EC%A6%9D\" aria-label=\"42 교차 검증 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>4.2. 교차 검증</h3>\n<p>모델이 학습 데이터에만 과도하게 최적화되어 실제 예측을 다른 데이터로 수행할 경우 예측 성능이 과도하게 떨어지는 과적합 현상을 막기 위해, 여러 개의 학습 데이터 세트와 테스트 데이터 세트에 대해 학습과 평가를 수행하는 교차 검증이 효율적일 수 있습니다.</p>\n<h4 id=\"431-k-폴드-교차-검증\" style=\"position:relative;\"><a href=\"#431-k-%ED%8F%B4%EB%93%9C-%EA%B5%90%EC%B0%A8-%EA%B2%80%EC%A6%9D\" aria-label=\"431 k 폴드 교차 검증 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>4.3.1. K 폴드 교차 검증</h4>\n<p>K폴드 교차 검증은 전체 데이터 세트를 K개의 데이터 폴드 세트로 만든 다음, 각 폴드 세트에 학습과 검증 평가를 반복적으로 수행하는 방법입니다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 1200px;\"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 50.33333333333333%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAKCAYAAAC0VX7mAAAACXBIWXMAAA7DAAAOwwHHb6hkAAABw0lEQVQoz21STW/UMBDNP+fCD+AvgFCFeuwFJKh64IYqoZbDSqVSdyGbdbJx/B17EzuPselWXcpI0UyczPO896aavEOcDpgPHss8oWM7NL9/gTU1nQfM9C2mhDjPWCjnWJblKR/rY1SH0cIqieAMnJZUC/B9CyN4qb3qYeo7OPaA4D1ijC9A8Qy08laXaUYCa5stAr13uy28s+i1g2Fr1BdvwK7egfd7jONI/elkwudP5WmyvmPwRoF3LfIFfBBw2zs0l28hbr5A8j0MTaukgLEWKb6kf6yJsoPgfaEsqDHoAQOrC+D++iPs/TU0SeKMLtkS4JJi0f0Imiinx7pQ7jLlTNEEmJ/f8HD2Cur7J3A9wjmHgTRVpKkUNKExhfJ8CMiGetJ1tVphs9mUf6tApgyZ4uYHmq/nsOtbAujgtYDoO9JWFDBLGispC+U8WQbMOZuUL8lgGbzyRpJ2DIaoNVfv4dY34HzASOcZ0BGgHMhpSWfUFEIolFOK+F9U5vYz7j+8hibAVlgyxRSXM2C3a6BFj75lxZjsslSqUP53F59cng3H2K4xWfF3z0jsZlsTzaEs9ZS1oqlynqfpZA9PdvEx/gBtFf6L1tgr5AAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"K-fold\"\n        title=\"K-fold\"\n        src=\"/static/ca7c26b2ecbd56ab4263413a676b3123/c1b63/2.png\"\n        srcset=\"/static/ca7c26b2ecbd56ab4263413a676b3123/5a46d/2.png 300w,\n/static/ca7c26b2ecbd56ab4263413a676b3123/0a47e/2.png 600w,\n/static/ca7c26b2ecbd56ab4263413a676b3123/c1b63/2.png 1200w,\n/static/ca7c26b2ecbd56ab4263413a676b3123/098c1/2.png 1578w\"\n        sizes=\"(max-width: 1200px) 100vw, 1200px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n    </span>\n예를 들어, k=5 일때는 그림과 같이 데이터 세트를 5개로 나눈 뒤 그 중 1개를 검증, 나머지 4개를 학습에 사용하는 것을 5회 반복한 후 각 결과를 평균 내어 평가 결과로 반영하면 됩니다.</p>\n<p>사이킷런의 KFold 클래스를 이용해 교차 검증을 쉽게 할 수 있습니다. 다음 예시를 살펴봅시다.</p>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token keyword\">from</span> sklearn<span class=\"token punctuation\">.</span>datasets <span class=\"token keyword\">import</span> load_iris\n<span class=\"token keyword\">from</span> sklearn<span class=\"token punctuation\">.</span>tree <span class=\"token keyword\">import</span> DecisionTreeClassifier\n<span class=\"token keyword\">from</span> sklearn<span class=\"token punctuation\">.</span>metrics <span class=\"token keyword\">import</span> accuracy_score\n<span class=\"token keyword\">from</span> sklearn<span class=\"token punctuation\">.</span>model_selection <span class=\"token keyword\">import</span> KFold\n<span class=\"token keyword\">import</span> numpy <span class=\"token keyword\">as</span> np\n\n\niris<span class=\"token operator\">=</span>load_iris<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\nfeatures<span class=\"token operator\">=</span>iris<span class=\"token punctuation\">.</span>data\nlabel<span class=\"token operator\">=</span>iris<span class=\"token punctuation\">.</span>target\ndt_clf<span class=\"token operator\">=</span>DecisionTreeClassifier<span class=\"token punctuation\">(</span>random_state<span class=\"token operator\">=</span><span class=\"token number\">156</span><span class=\"token punctuation\">)</span>\n\n<span class=\"token comment\">#5개의 폴드 세트로 분리하는 KFold 객체와 폴드 세트별 정확도를 담을 리스트 객체 생성</span>\nkfold <span class=\"token operator\">=</span> KFold<span class=\"token punctuation\">(</span>n_splits<span class=\"token operator\">=</span><span class=\"token number\">5</span><span class=\"token punctuation\">)</span>\ncv_accuracy <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span>\n\nn_iter<span class=\"token operator\">=</span><span class=\"token number\">0</span>\n\n<span class=\"token comment\"># KFold 객체의 split()를 호출하면 폴드별 학습용, 검증용 테스트의 로우 인덱스를 array로 변환</span>\n<span class=\"token keyword\">for</span> train_index<span class=\"token punctuation\">,</span> test_index <span class=\"token keyword\">in</span> kfold<span class=\"token punctuation\">.</span>split<span class=\"token punctuation\">(</span>features<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n\n    <span class=\"token comment\">#kfold.split()으로 반환된 인덱스를 이용해 학습용, 검증용 테스트 데이터 추출</span>\n    X_train<span class=\"token punctuation\">,</span> X_test <span class=\"token operator\">=</span> features<span class=\"token punctuation\">[</span>train_index<span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> features<span class=\"token punctuation\">[</span>test_index<span class=\"token punctuation\">]</span>\n    y_train<span class=\"token punctuation\">,</span> y_test <span class=\"token operator\">=</span> label<span class=\"token punctuation\">[</span>train_index<span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> label<span class=\"token punctuation\">[</span>test_index<span class=\"token punctuation\">]</span>\n\n    <span class=\"token comment\">#학습 및 예측</span>\n    dt_clf<span class=\"token punctuation\">.</span>fit<span class=\"token punctuation\">(</span>X_train<span class=\"token punctuation\">,</span> y_train<span class=\"token punctuation\">)</span>\n    pred<span class=\"token operator\">=</span>dt_clf<span class=\"token punctuation\">.</span>predict<span class=\"token punctuation\">(</span>X_test<span class=\"token punctuation\">)</span>\n    n_iter <span class=\"token operator\">+=</span> <span class=\"token number\">1</span>\n\n    <span class=\"token comment\">#정확도 측정</span>\n    accuracy<span class=\"token operator\">=</span>np<span class=\"token punctuation\">.</span><span class=\"token builtin\">round</span><span class=\"token punctuation\">(</span>accuracy_score<span class=\"token punctuation\">(</span>y_test<span class=\"token punctuation\">,</span> pred<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span><span class=\"token number\">4</span><span class=\"token punctuation\">)</span>\n    train_size<span class=\"token operator\">=</span>X_train<span class=\"token punctuation\">.</span>shape<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span>\n    test_size<span class=\"token operator\">=</span>X_test<span class=\"token punctuation\">.</span>shape<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span>\n    <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">'\\n#{0} 교차 검증 정확도 :{1}, 학습 데이터 크기: {2}, 검증 데이터 크기: {3}'</span><span class=\"token punctuation\">.</span><span class=\"token builtin\">format</span><span class=\"token punctuation\">(</span>n_iter<span class=\"token punctuation\">,</span> accuracy<span class=\"token punctuation\">,</span> train_size<span class=\"token punctuation\">,</span> test_size<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n    cv_accuracy<span class=\"token punctuation\">.</span>append<span class=\"token punctuation\">(</span>accuracy<span class=\"token punctuation\">)</span>\n\n<span class=\"token comment\">#평균 정확도 계산</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">'\\n## 평균 검증 정확도:'</span><span class=\"token punctuation\">,</span> np<span class=\"token punctuation\">.</span>mean<span class=\"token punctuation\">(</span>cv_accuracy<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span></code></pre></div>\n<p>[실행 결과]</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">#1 교차 검증 정확도 :1.0, 학습 데이터 크기: 120, 검증 데이터 크기: 30\n\n#2 교차 검증 정확도 :0.9667, 학습 데이터 크기: 120, 검증 데이터 크기: 30\n\n#3 교차 검증 정확도 :0.8667, 학습 데이터 크기: 120, 검증 데이터 크기: 30\n\n#4 교차 검증 정확도 :0.9333, 학습 데이터 크기: 120, 검증 데이터 크기: 30\n\n#5 교차 검증 정확도 :0.7333, 학습 데이터 크기: 120, 검증 데이터 크기: 30\n\n## 평균 검증 정확도: 0.9</code></pre></div>\n<p>전체 데이터 세트 150 개를 5등분 하였으므로 120개의 학습 데이터와 30개의 검증 데이터로 학습과 검증이 진행되는 것을 확인할 수 있습니다. 학습 데이터와 검증 데이터가 변하기 때문에 매번 검증 정확도가 달라지며, 교차 검증 정확도의 평균으로 전체 정확도를 측정할 수 있습니다.</p>\n<h4 id=\"432-stratified-k-폴드\" style=\"position:relative;\"><a href=\"#432-stratified-k-%ED%8F%B4%EB%93%9C\" aria-label=\"432 stratified k 폴드 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>4.3.2. Stratified K 폴드</h4>\n<p>Stratified K 폴드는 특정 레이블 값이 특이하게 많거나 매우 적어 값의 분포가 한쪽으로 치우치는 불균형한 분포도를 가진 레이블 데이터 집합을 위한 K 폴드 방식입니다. Stratified K 폴드는 원본 데이터의 레이블 분포를 먼저 고려한 뒤, 이 분포와 동일하게 학습과 검증 데이터 세트를 분배합니다.</p>\n<p>우선 붓꽃 데이터 세트에서 레이블 값의 분포도를 확인합시다.</p>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token keyword\">import</span> pandas <span class=\"token keyword\">as</span> pd\n\niris <span class=\"token operator\">=</span> load_iris<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\niris_df <span class=\"token operator\">=</span> pd<span class=\"token punctuation\">.</span>DataFrame<span class=\"token punctuation\">(</span>data <span class=\"token operator\">=</span> iris<span class=\"token punctuation\">.</span>data<span class=\"token punctuation\">,</span> columns <span class=\"token operator\">=</span> iris<span class=\"token punctuation\">.</span>feature_names<span class=\"token punctuation\">)</span>\niris_df<span class=\"token punctuation\">[</span><span class=\"token string\">'label'</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> iris<span class=\"token punctuation\">.</span>target\niris_df<span class=\"token punctuation\">[</span><span class=\"token string\">'label'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>value_counts<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></code></pre></div>\n<p>[실행 결과]</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">0    50\n1    50\n2    50\nName: label, dtype: int64</code></pre></div>\n<p>확인 결과 레이블 값은 0, 1, 2 모두 50개로 동일합니다. <code class=\"language-text\">StratifiedKFold</code> 를 수행하고 각 교차 검증에서 학습과 검증 레이블데이터의 분포를 살펴보겠습니다. 이때 주의하여야 할 점은 <code class=\"language-text\">StratifiedKFold</code> 를 사용할 때는 <code class=\"language-text\">split()</code> 매서드의 인자로 피처 데이터 세트 뿐만 아니라 레이블 데이터 세트도 반드시 필요하다는 사실입니다.</p>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token keyword\">from</span> sklearn<span class=\"token punctuation\">.</span>model_selection <span class=\"token keyword\">import</span> StratifiedKFold\n\nskf <span class=\"token operator\">=</span> StratifiedKFold<span class=\"token punctuation\">(</span>n_splits<span class=\"token operator\">=</span><span class=\"token number\">3</span><span class=\"token punctuation\">)</span>\nn_iter<span class=\"token operator\">=</span><span class=\"token number\">0</span>\n\n<span class=\"token keyword\">for</span> train_index<span class=\"token punctuation\">,</span> test_index <span class=\"token keyword\">in</span> skf<span class=\"token punctuation\">.</span>split<span class=\"token punctuation\">(</span>iris_df<span class=\"token punctuation\">,</span> iris_df<span class=\"token punctuation\">[</span><span class=\"token string\">'label'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n    n_iter<span class=\"token operator\">+=</span><span class=\"token number\">1</span>\n    label_train <span class=\"token operator\">=</span> iris_df<span class=\"token punctuation\">[</span><span class=\"token string\">'label'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>iloc<span class=\"token punctuation\">[</span>train_index<span class=\"token punctuation\">]</span>\n    label_test <span class=\"token operator\">=</span> iris_df<span class=\"token punctuation\">[</span><span class=\"token string\">'label'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>iloc<span class=\"token punctuation\">[</span>test_index<span class=\"token punctuation\">]</span>\n    <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">'## 교차 검증: {0}'</span><span class=\"token punctuation\">.</span><span class=\"token builtin\">format</span><span class=\"token punctuation\">(</span>n_iter<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n    <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">'학습 레이블 데이터 분포:\\n'</span><span class=\"token punctuation\">,</span> label_train<span class=\"token punctuation\">.</span>value_counts<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n    <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">'검증 레이블 데이터 분포:\\n'</span><span class=\"token punctuation\">,</span> label_test<span class=\"token punctuation\">.</span>value_counts<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span></code></pre></div>\n<p>[실행 결과]</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">## 교차 검증: 1\n학습 레이블 데이터 분포:\n 2    34\n0    33\n1    33\nName: label, dtype: int64\n검증 레이블 데이터 분포:\n 0    17\n1    17\n2    16\nName: label, dtype: int64\n## 교차 검증: 2\n학습 레이블 데이터 분포:\n 1    34\n0    33\n2    33\nName: label, dtype: int64\n검증 레이블 데이터 분포:\n 0    17\n2    17\n1    16\nName: label, dtype: int64\n## 교차 검증: 3\n학습 레이블 데이터 분포:\n 0    34\n1    33\n2    33\nName: label, dtype: int64\n검증 레이블 데이터 분포:\n 1    17\n2    17\n0    16\nName: label, dtype: int64</code></pre></div>\n<p><code class=\"language-text\">StratifiedKFold</code> 를 사용하면 학습 레이블과 검증 레이블 데이터 값의 분포도가 동일하게 할당되었음을 확인할 수 있습니다. 이를 활용하여 붓꽃 데이터를 교차 검증하면 다음과 같습니다.</p>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token keyword\">from</span> sklearn<span class=\"token punctuation\">.</span>datasets <span class=\"token keyword\">import</span> load_iris\n<span class=\"token keyword\">from</span> sklearn<span class=\"token punctuation\">.</span>tree <span class=\"token keyword\">import</span> DecisionTreeClassifier\n<span class=\"token keyword\">from</span> sklearn<span class=\"token punctuation\">.</span>metrics <span class=\"token keyword\">import</span> accuracy_score\n<span class=\"token keyword\">from</span> sklearn<span class=\"token punctuation\">.</span>model_selection <span class=\"token keyword\">import</span> StratifiedKFold\n<span class=\"token keyword\">import</span> numpy <span class=\"token keyword\">as</span> np\n\niris<span class=\"token operator\">=</span>load_iris<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\nfeatures<span class=\"token operator\">=</span>iris<span class=\"token punctuation\">.</span>data\nlabel<span class=\"token operator\">=</span>iris<span class=\"token punctuation\">.</span>target\ndt_clf<span class=\"token operator\">=</span>DecisionTreeClassifier<span class=\"token punctuation\">(</span>random_state<span class=\"token operator\">=</span><span class=\"token number\">156</span><span class=\"token punctuation\">)</span>\n\nskf <span class=\"token operator\">=</span> StratifiedKFold<span class=\"token punctuation\">(</span>n_splits<span class=\"token operator\">=</span><span class=\"token number\">3</span><span class=\"token punctuation\">)</span>\nn_iter<span class=\"token operator\">=</span><span class=\"token number\">0</span>\ncv_accuracy<span class=\"token operator\">=</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span>\n\n<span class=\"token keyword\">for</span> train_index<span class=\"token punctuation\">,</span> test_index <span class=\"token keyword\">in</span> skf<span class=\"token punctuation\">.</span>split<span class=\"token punctuation\">(</span>features<span class=\"token punctuation\">,</span> label<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n    X_train<span class=\"token punctuation\">,</span> X_test <span class=\"token operator\">=</span> features<span class=\"token punctuation\">[</span>train_index<span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> features<span class=\"token punctuation\">[</span>test_index<span class=\"token punctuation\">]</span>\n    y_train<span class=\"token punctuation\">,</span> y_test <span class=\"token operator\">=</span> label<span class=\"token punctuation\">[</span>train_index<span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> label<span class=\"token punctuation\">[</span>test_index<span class=\"token punctuation\">]</span>\n\n    dt_clf<span class=\"token punctuation\">.</span>fit<span class=\"token punctuation\">(</span>X_train<span class=\"token punctuation\">,</span> y_train<span class=\"token punctuation\">)</span>\n    pred<span class=\"token operator\">=</span>dt_clf<span class=\"token punctuation\">.</span>predict<span class=\"token punctuation\">(</span>X_test<span class=\"token punctuation\">)</span>\n\n    n_iter <span class=\"token operator\">+=</span> <span class=\"token number\">1</span>\n    accuracy<span class=\"token operator\">=</span>np<span class=\"token punctuation\">.</span><span class=\"token builtin\">round</span><span class=\"token punctuation\">(</span>accuracy_score<span class=\"token punctuation\">(</span>y_test<span class=\"token punctuation\">,</span> pred<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> <span class=\"token number\">4</span><span class=\"token punctuation\">)</span>\n    train_size<span class=\"token operator\">=</span>X_train<span class=\"token punctuation\">.</span>shape<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span>\n    test_size<span class=\"token operator\">=</span>X_test<span class=\"token punctuation\">.</span>shape<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span>\n    <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">'\\n#{0} 교차 검증 정확도 :{1}, 학습 데이터 크기: {2}, 검증 데이터 크기: {3}'</span><span class=\"token punctuation\">.</span><span class=\"token builtin\">format</span><span class=\"token punctuation\">(</span>n_iter<span class=\"token punctuation\">,</span> accuracy<span class=\"token punctuation\">,</span> train_size<span class=\"token punctuation\">,</span> test_size<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n    cv_accuracy<span class=\"token punctuation\">.</span>append<span class=\"token punctuation\">(</span>accuracy<span class=\"token punctuation\">)</span>\n\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">'\\n## 교차 검증별 정확도:'</span><span class=\"token punctuation\">,</span> np<span class=\"token punctuation\">.</span><span class=\"token builtin\">round</span><span class=\"token punctuation\">(</span>cv_accuracy<span class=\"token punctuation\">,</span> <span class=\"token number\">4</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">'## 평균 검증 정확도:'</span><span class=\"token punctuation\">,</span> np<span class=\"token punctuation\">.</span>mean<span class=\"token punctuation\">(</span>cv_accuracy<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span></code></pre></div>\n<p>[실행 결과]</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">#1 교차 검증 정확도 :0.98, 학습 데이터 크기: 100, 검증 데이터 크기: 50\n\n#2 교차 검증 정확도 :0.94, 학습 데이터 크기: 100, 검증 데이터 크기: 50\n\n#3 교차 검증 정확도 :0.98, 학습 데이터 크기: 100, 검증 데이터 크기: 50\n\n## 교차 검증별 정확도: [0.98 0.94 0.98]\n## 평균 검증 정확도: 0.9666666666666667</code></pre></div>\n<p>3 개의 <code class=\"language-text\">Stratified K 폴드</code>로 교차 검증한 결과 평균 검증 정확도가 96.7% 정도임을 확인할 수 있습니다. 왜곡된 레이블 데이터 세트에서는 반드시 <code class=\"language-text\">Stratified K 폴드</code>를 이용해 교차 검증해야 합니다.</p>\n<h4 id=\"433-교차-검증을-보다-간편하게--crossvalscore\" style=\"position:relative;\"><a href=\"#433-%EA%B5%90%EC%B0%A8-%EA%B2%80%EC%A6%9D%EC%9D%84-%EB%B3%B4%EB%8B%A4-%EA%B0%84%ED%8E%B8%ED%95%98%EA%B2%8C--crossvalscore\" aria-label=\"433 교차 검증을 보다 간편하게  crossvalscore permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>4.3.3. 교차 검증을 보다 간편하게- cross<em>val</em>score()</h4>\n<p>사이킷런은 교차 검증을 좀 더 편리하게 수행할 수 있는 <code class=\"language-text\">cross_val_score()</code> API 를 제공합니다. 다음과 같은 형태로 선언합니다.</p>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\">cross_val_score<span class=\"token punctuation\">(</span>estimator<span class=\"token punctuation\">,</span> X<span class=\"token punctuation\">,</span> y<span class=\"token operator\">=</span><span class=\"token boolean\">None</span><span class=\"token punctuation\">,</span> scoring<span class=\"token operator\">=</span><span class=\"token boolean\">None</span><span class=\"token punctuation\">,</span> cv<span class=\"token operator\">=</span><span class=\"token boolean\">None</span><span class=\"token punctuation\">,</span> n_jobs<span class=\"token operator\">=</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span> verbose<span class=\"token operator\">=</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span> fit_params<span class=\"token operator\">=</span><span class=\"token boolean\">None</span><span class=\"token punctuation\">,</span> pre_dispatch<span class=\"token operator\">=</span><span class=\"token string\">'2*n_jobs'</span><span class=\"token punctuation\">)</span></code></pre></div>\n<p>이중 주요 파라미터는 <code class=\"language-text\">estimator</code>, <code class=\"language-text\">X</code>, <code class=\"language-text\">y</code>, <code class=\"language-text\">scoring</code>, <code class=\"language-text\">cv</code> 입니다. <code class=\"language-text\">estimator</code>는 사이킷런의 분류 또는 회귀 알고리즘 클래스를 의미하며, <code class=\"language-text\">X</code>는 피처 데이터 세트, <code class=\"language-text\">y</code>는 레이블 데이터 세트, <code class=\"language-text\">scoring</code>은 예측 성능 평가 지표, <code class=\"language-text\">cv</code>는 교차 검증 폴드 수를 의미합니다. <code class=\"language-text\">cross_val_score()</code>는 실행되면 <code class=\"language-text\">Stratified K 폴드</code> 방식으로 진행한 교차 검증의 <code class=\"language-text\">scoring</code> 파라미터 성능 지표 값을 배열로 반환합니다.</p>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token keyword\">from</span> sklearn<span class=\"token punctuation\">.</span>tree <span class=\"token keyword\">import</span> DecisionTreeClassifier\n<span class=\"token keyword\">from</span> sklearn<span class=\"token punctuation\">.</span>model_selection <span class=\"token keyword\">import</span> cross_val_score<span class=\"token punctuation\">,</span> cross_validate\n<span class=\"token keyword\">from</span> sklearn<span class=\"token punctuation\">.</span>datasets <span class=\"token keyword\">import</span> load_iris\n\niris_data<span class=\"token operator\">=</span>load_iris<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\ndt_clf<span class=\"token operator\">=</span>DecisionTreeClassifier<span class=\"token punctuation\">(</span>random_state<span class=\"token operator\">=</span><span class=\"token number\">156</span><span class=\"token punctuation\">)</span>\n\ndata<span class=\"token operator\">=</span>iris_data<span class=\"token punctuation\">.</span>data\nlabel<span class=\"token operator\">=</span>iris_data<span class=\"token punctuation\">.</span>target\n\nscores<span class=\"token operator\">=</span>cross_val_score<span class=\"token punctuation\">(</span>dt_clf<span class=\"token punctuation\">,</span>data<span class=\"token punctuation\">,</span>label<span class=\"token punctuation\">,</span>scoring<span class=\"token operator\">=</span><span class=\"token string\">'accuracy'</span><span class=\"token punctuation\">,</span>cv<span class=\"token operator\">=</span><span class=\"token number\">3</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">'교차 검증별 정확도:'</span><span class=\"token punctuation\">,</span> np<span class=\"token punctuation\">.</span><span class=\"token builtin\">round</span><span class=\"token punctuation\">(</span>scores<span class=\"token punctuation\">,</span><span class=\"token number\">4</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">'평균 검증 정확도:'</span><span class=\"token punctuation\">,</span> np<span class=\"token punctuation\">.</span><span class=\"token builtin\">round</span><span class=\"token punctuation\">(</span>np<span class=\"token punctuation\">.</span>mean<span class=\"token punctuation\">(</span>scores<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span><span class=\"token number\">4</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span></code></pre></div>\n<p>[실행 결과]</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">교차 검증별 정확도: [0.98 0.94 0.98]\n평균 검증 정확도: 0.9667</code></pre></div>\n<p>주어진 파라미터에 따라 3개의 교차 검증 세트로 측정한 정확도를 확인할 수 있습니다. 비슷한 API로, 여러 평가 지표에 대한 성능을 확인하고 싶을 때에는 <code class=\"language-text\">cross_validate()</code> 를 사용하면 됩니다.</p>\n<h4 id=\"434-gridsearchcv---교차-검증과-하이퍼-파라미터-튜닝을-한-번에\" style=\"position:relative;\"><a href=\"#434-gridsearchcv---%EA%B5%90%EC%B0%A8-%EA%B2%80%EC%A6%9D%EA%B3%BC-%ED%95%98%EC%9D%B4%ED%8D%BC-%ED%8C%8C%EB%9D%BC%EB%AF%B8%ED%84%B0-%ED%8A%9C%EB%8B%9D%EC%9D%84-%ED%95%9C-%EB%B2%88%EC%97%90\" aria-label=\"434 gridsearchcv   교차 검증과 하이퍼 파라미터 튜닝을 한 번에 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>4.3.4. GridSearchCV - 교차 검증과 하이퍼 파라미터 튜닝을 한 번에</h4>\n<p>하이퍼 파라미터는 머신 러닝 알고리즘을 구성하는 주요 요소로, 이 값을 조정하여 예측 성능을 개선시킬 수 있습니다. 하이퍼 파라미터를 순차적으로 변경하면서 최고 성능을 가지는 파라미터 조합을 찾고자 한다면 해당 파라미터의 집합을 딕셔너리의 형태로 설정하고 <code class=\"language-text\">GridSearchCV</code> 를 사용한다면 최적의 파라미터와 수행 결과를 찾을 수 있습니다. <code class=\"language-text\">GridSearchCV</code>의 주요 파라미터는 <code class=\"language-text\">estimator</code>, 튜닝할 파라미터의 딕셔너리인 <code class=\"language-text\">param_grid</code>, <code class=\"language-text\">scoring</code>, 교차 검증 세트의 개수인 <code class=\"language-text\">cv</code>, 최적 학습 파라미터로 <code class=\"language-text\">estimator</code> 객체를 재학습시킬지의 유무를 결정하는 <code class=\"language-text\">refit</code> 이 있습니다. 다음 예시를 살펴봅시다.</p>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token keyword\">from</span> sklearn<span class=\"token punctuation\">.</span>datasets <span class=\"token keyword\">import</span> load_iris\n<span class=\"token keyword\">from</span> sklearn<span class=\"token punctuation\">.</span>tree <span class=\"token keyword\">import</span> DecisionTreeClassifier\n<span class=\"token keyword\">from</span> sklearn<span class=\"token punctuation\">.</span>model_selection <span class=\"token keyword\">import</span> GridSearchCV\n<span class=\"token keyword\">import</span> pandas <span class=\"token keyword\">as</span> pd\n\n<span class=\"token comment\">#데이터를 로딩하고 학습과 테스트 데이터 분리</span>\niris_data<span class=\"token operator\">=</span>load_iris<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\nX_train<span class=\"token punctuation\">,</span> X_test<span class=\"token punctuation\">,</span> y_train<span class=\"token punctuation\">,</span> y_test <span class=\"token operator\">=</span> train_test_split<span class=\"token punctuation\">(</span>iris_data<span class=\"token punctuation\">.</span>data<span class=\"token punctuation\">,</span> iris_data<span class=\"token punctuation\">.</span>target<span class=\"token punctuation\">,</span> test_size<span class=\"token operator\">=</span><span class=\"token number\">0.2</span><span class=\"token punctuation\">,</span> random_state<span class=\"token operator\">=</span><span class=\"token number\">121</span><span class=\"token punctuation\">)</span>\ndtree <span class=\"token operator\">=</span> DecisionTreeClassifier<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n\n<span class=\"token comment\">#튜닝할 파라미터를 딕셔너리의 형태로 결정</span>\nparameters<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span><span class=\"token string\">'max_depth'</span><span class=\"token punctuation\">:</span><span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span><span class=\"token number\">2</span><span class=\"token punctuation\">,</span><span class=\"token number\">3</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'min_samples_split'</span><span class=\"token punctuation\">:</span><span class=\"token punctuation\">[</span><span class=\"token number\">2</span><span class=\"token punctuation\">,</span><span class=\"token number\">3</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">}</span>\n\ngrid_dtree<span class=\"token operator\">=</span>GridSearchCV<span class=\"token punctuation\">(</span>dtree<span class=\"token punctuation\">,</span>param_grid<span class=\"token operator\">=</span>parameters<span class=\"token punctuation\">,</span> cv<span class=\"token operator\">=</span><span class=\"token number\">3</span><span class=\"token punctuation\">,</span> refit<span class=\"token operator\">=</span><span class=\"token boolean\">True</span><span class=\"token punctuation\">)</span>\ngrid_dtree<span class=\"token punctuation\">.</span>fit<span class=\"token punctuation\">(</span>X_train<span class=\"token punctuation\">,</span> y_train<span class=\"token punctuation\">)</span>\n\nscores_df<span class=\"token operator\">=</span>pd<span class=\"token punctuation\">.</span>DataFrame<span class=\"token punctuation\">(</span>grid_dtree<span class=\"token punctuation\">.</span>cv_results_<span class=\"token punctuation\">)</span>\nscores_df<span class=\"token punctuation\">[</span><span class=\"token punctuation\">[</span><span class=\"token string\">'params'</span><span class=\"token punctuation\">,</span><span class=\"token string\">'mean_test_score'</span><span class=\"token punctuation\">,</span><span class=\"token string\">'rank_test_score'</span><span class=\"token punctuation\">,</span><span class=\"token string\">'split0_test_score'</span><span class=\"token punctuation\">,</span><span class=\"token string\">'split1_test_score'</span><span class=\"token punctuation\">,</span><span class=\"token string\">'split2_test_score'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span></code></pre></div>\n<p>[실행 결과]\n<span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 855px;\"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 36.66666666666667%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAHCAYAAAAIy204AAAACXBIWXMAAA7DAAAOwwHHb6hkAAABH0lEQVQozz2RV5LCQAxE5yjYOIAzpggOGBN2F/jg/rfR6qkYPlRua3parR6XZZlQ6/XavuPpJMe+l0G/1/vd8DhN0o+j9ebr1TiD/k/zLN0w2Pn5cpFOuS5JEgmCQPKikEmbf6+XlFUly+XSRIqylDAMJUlTqyiKZNO2kiqGk+e5xKoRx7FUdS2OA0Qh/Twe8nq/pdls7OLucDBB8Gq1soJbN41hRBD0GhhxkBeLhV3ENqKFuqXnnYBxQ7EN5x4j5HGm4o7svMP5dpPf59McMv3YdVLqILA5/HDb7faLEeeMwY06/2aIOgHjEkxvt9/bQ5lD3YQiT7JiMzipikWfPsMdk3DA/rwgDskIEgPssq6EA5+VOSRD5fCY6SdbNvsHlp/V1u/Sk40AAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"실행결과\"\n        title=\"실행결과\"\n        src=\"/static/fa15d74471c2eb56d30cb1ec5a15e9de/77800/3.png\"\n        srcset=\"/static/fa15d74471c2eb56d30cb1ec5a15e9de/5a46d/3.png 300w,\n/static/fa15d74471c2eb56d30cb1ec5a15e9de/0a47e/3.png 600w,\n/static/fa15d74471c2eb56d30cb1ec5a15e9de/77800/3.png 855w\"\n        sizes=\"(max-width: 855px) 100vw, 855px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n    </span></p>\n<p>하이퍼 파라미터 <code class=\"language-text\">max_depth</code> 와 <code class=\"language-text\">min_samples_split</code>을 각각 변화 시켜 가며 6번 학습을 시킨 후 평가 결과를 확인할 수 있습니다. 하이퍼 파라미터 값에 대해 각 폴드 평가 결과와, 전체 평균, 그리고 전체 평균의 순위를 확인할 수 있습니다.</p>\n<p><code class=\"language-text\">fit()</code> 을 수행하고 나면 <code class=\"language-text\">best_params_</code>, <code class=\"language-text\">best_score_</code> 속성에 최고 성능을 나타낸 파라미터와 결과값이 저장됩니다. 그 값을 알아보고 파라미터로 학습된 모델을 이용해 새로운 테스트 데이터 세트에 대한 예측 결과를 알아보겠습니다.</p>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">'GridSearchCV 최적 파라미터:'</span><span class=\"token punctuation\">,</span>grid_dtree<span class=\"token punctuation\">.</span>best_params_<span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">'GridSearchCv 최적 정확도:{0:.4f}'</span><span class=\"token punctuation\">.</span><span class=\"token builtin\">format</span><span class=\"token punctuation\">(</span>grid_dtree<span class=\"token punctuation\">.</span>best_score_<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n\nestimator<span class=\"token operator\">=</span>grid_dtree<span class=\"token punctuation\">.</span>best_estimator_\n\npred<span class=\"token operator\">=</span>estimator<span class=\"token punctuation\">.</span>predict<span class=\"token punctuation\">(</span>X_test<span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">'테스트 데이터 세트 정확도: {0:.4f}'</span><span class=\"token punctuation\">.</span><span class=\"token builtin\">format</span><span class=\"token punctuation\">(</span>accuracy_score<span class=\"token punctuation\">(</span>y_test<span class=\"token punctuation\">,</span>pred<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span></code></pre></div>\n<p>[실행 결과]</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">GridSearchCV 최적 파라미터: {'max_depth': 3, 'min_samples_split': 2}\nGridSearchCv 최적 정확도:0.9750\n테스트 데이터 세트 정확도: 0.9667</code></pre></div>\n<p>Chapter 2 의 나머지 내용은 <a href=\"https://kunheekimkr.github.io/ML/chapter2-2/\">다음 글</a> 에서 이어서 설명하겠습니다.</p>","frontmatter":{"title":"[파이썬 머신러닝 완벽 가이드] 2.사이킷런으로 시작하는 머신러닝(1)","date":"February 02, 2022"}}},"pageContext":{"slug":"/ML/chapter2-1/","previous":{"fields":{"slug":"/ML/chapter1-2/"},"frontmatter":{"title":"[파이썬 머신러닝 완벽 가이드] 1.파이썬 기반의 머신 러닝과 생태계 이해(2)"}},"next":{"fields":{"slug":"/ML/chapter2-2/"},"frontmatter":{"title":"[파이썬 머신러닝 완벽 가이드] 2.사이킷런으로 시작하는 머신러닝(2)"}}}},"staticQueryHashes":["2486386679","3128451518"]}