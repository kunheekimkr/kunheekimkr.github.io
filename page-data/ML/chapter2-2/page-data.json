{"componentChunkName":"component---src-templates-blog-post-js","path":"/ML/chapter2-2/","result":{"data":{"site":{"siteMetadata":{"title":"KunheeKim.Dev","author":"[Kunhee Kim]","siteUrl":"https://kunheekimkr.github.io","comment":{"disqusShortName":"","utterances":"kunheekimkr/kunheekimkr.github.io"},"sponsor":{"buyMeACoffeeId":""}}},"markdownRemark":{"id":"b414261a-0012-563b-9ba2-2005bef35599","excerpt":"Chapter 1 의 이전 내용은 이전 글 을 확인해 주세요! 5. 데이터 전처리 데이터 전처리 과정은 ML 알고리즘만큼 중요합니다. 사이킷런의 ML 알고리즘을 적용하기 전에 데이터에 대해 미리 처리해야할 사항이 있습니다. 우선 결손값 NaN과 Null 은 허용되지 않기 때문에 적당한 값으로 대체되거나 피처가 제거되어야 하며, 사이킷런의 머신러닝 알고리즘은 문자열 값을 입력 값으로 허용하지 않기 때문에 인코딩돼서 숫자 형으로 변환되어야 합니다. 5.1. 데이터 인코딩 5.1.…","html":"<p>Chapter 1 의 이전 내용은 <a href=\"https://kunheekimkr.github.io/ML/chapter2-1/\">이전 글</a> 을 확인해 주세요!</p>\n<h2 id=\"5-데이터-전처리\" style=\"position:relative;\"><a href=\"#5-%EB%8D%B0%EC%9D%B4%ED%84%B0-%EC%A0%84%EC%B2%98%EB%A6%AC\" aria-label=\"5 데이터 전처리 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>5. 데이터 전처리</h2>\n<p>데이터 전처리 과정은 ML 알고리즘만큼 중요합니다. 사이킷런의 ML 알고리즘을 적용하기 전에 데이터에 대해 미리 처리해야할 사항이 있습니다. 우선 결손값 NaN과 Null 은 허용되지 않기 때문에 적당한 값으로 대체되거나 피처가 제거되어야 하며, 사이킷런의 머신러닝 알고리즘은 문자열 값을 입력 값으로 허용하지 않기 때문에 인코딩돼서 숫자 형으로 변환되어야 합니다.</p>\n<h3 id=\"51-데이터-인코딩\" style=\"position:relative;\"><a href=\"#51-%EB%8D%B0%EC%9D%B4%ED%84%B0-%EC%9D%B8%EC%BD%94%EB%94%A9\" aria-label=\"51 데이터 인코딩 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>5.1. 데이터 인코딩</h3>\n<h4 id=\"511-레이블-인코딩\" style=\"position:relative;\"><a href=\"#511-%EB%A0%88%EC%9D%B4%EB%B8%94-%EC%9D%B8%EC%BD%94%EB%94%A9\" aria-label=\"511 레이블 인코딩 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>5.1.1. 레이블 인코딩</h4>\n<p>레이블 인코딩은 카테고리 피처를 코드형 숫자 값으로 변환하는 것입니다. 예를 들어 상품 구분 ‘TV’, ‘냉장고’, ‘전자레인지’, ‘컴퓨터’, ‘선풍기’, ‘믹서’ 가 있다면, TV:0, 냉장고:1, 전자레인지:2, 컴퓨터:3, 선풍기:4, 믹서:5 과 같은숫자 값으로 변환하는 것입니다. 이는 사이킷런의 <code class=\"language-text\">LabelEncoder</code> 클래스를 이용해 쉽게 구현이 가능합니다.</p>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token keyword\">from</span> sklearn<span class=\"token punctuation\">.</span>preprocessing <span class=\"token keyword\">import</span> LabelEncoder\n\nitems<span class=\"token operator\">=</span><span class=\"token punctuation\">[</span><span class=\"token string\">'TV'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'냉장고'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'전자레인지'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'컴퓨터'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'선풍기'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'선풍기'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'믹서'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'믹서'</span><span class=\"token punctuation\">]</span>\n\nencoder<span class=\"token operator\">=</span>LabelEncoder<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\nencoder<span class=\"token punctuation\">.</span>fit<span class=\"token punctuation\">(</span>items<span class=\"token punctuation\">)</span>\nlabels <span class=\"token operator\">=</span> encoder<span class=\"token punctuation\">.</span>transform<span class=\"token punctuation\">(</span>items<span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">'인코딩 변환값:'</span><span class=\"token punctuation\">,</span> labels<span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">'인코딩 클래스:'</span><span class=\"token punctuation\">,</span>encoder<span class=\"token punctuation\">.</span>classes_<span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">'디코딩 원본값:'</span><span class=\"token punctuation\">,</span>encoder<span class=\"token punctuation\">.</span>inverse_transform<span class=\"token punctuation\">(</span>labels<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span></code></pre></div>\n<p>[실행 결과]</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">인코딩 변환값: [0 1 4 5 3 3 2 2]\n인코딩 클래스: ['TV' '냉장고' '믹서' '선풍기' '전자레인지' '컴퓨터']\n디코딩 원본값: ['TV' '냉장고' '전자레인지' '컴퓨터' '선풍기' '선풍기' '믹서' '믹서']</code></pre></div>\n<p><code class=\"language-text\">fit()</code> 매서드를 호출해 레이블 인코딩을 수행할 수 있습니다. <code class=\"language-text\">classes_</code> 속성에 0번부터 순서대로 변환된 인코딩 값에 대한 원본값을 가지고 있으며, <code class=\"language-text\">inverse_transform()</code>을 통해 인코딩된 값을 다시 디코딩할 수 있습니다.</p>\n<p>레이블 인코딩은 문자열 값이 숫자형 카테고리 값으로 변환되면서 숫자 값의 크고 작음에 대한 특성이 작용하기 때문에 특정 ML 알고리즘에서 예측 성능이 떨어지는 문제가 발생할 수 있습니다. 이러한 특성 때문에 레이블 인코딩은 선형 회귀와 같은 ML 알고리즘에는 적영되지 않아야 합니다. 트리 계열의 ML 알고리즘은 숫자의 크고 작음 특성을 반영하지 않으므로 레이블 인코딩이 사용되어도 됩니다.</p>\n<h4 id=\"512-원-핫-인코딩-one-hot-encoding\" style=\"position:relative;\"><a href=\"#512-%EC%9B%90-%ED%95%AB-%EC%9D%B8%EC%BD%94%EB%94%A9-one-hot-encoding\" aria-label=\"512 원 핫 인코딩 one hot encoding permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>5.1.2. 원-핫 인코딩 (One-Hot Encoding)</h4>\n<p>원-핫 인코딩은 피처 값의 유형에 따라 새로운 피처를 추가하고 고유 값에 해당하는 칼럼에만 1을 표시하고 나머지 말럼은 0을 표시하는 방식입니다. 예를 들어, 위의 예시에서 ‘TV’, ‘냉장고’, ‘전자레인지’, ‘컴퓨터’, ‘선풍기’, ‘믹서’ 라는 칼럼을 모두 만들어준 후, TV 인 경우에는 TV 칼럼에 1을, 나머지 칼럼에는 0을 표시하는 방식입니다. 이는 사이킷런의 <code class=\"language-text\">OneHotEncoder</code> 클래스를 이용해 쉽게 구현이 가능합니다.</p>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token keyword\">from</span> sklearn<span class=\"token punctuation\">.</span>preprocessing <span class=\"token keyword\">import</span> LabelEncoder<span class=\"token punctuation\">,</span> OneHotEncoder\n<span class=\"token keyword\">import</span> numpy <span class=\"token keyword\">as</span> np\n\nitems<span class=\"token operator\">=</span><span class=\"token punctuation\">[</span><span class=\"token string\">'TV'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'냉장고'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'전자레인지'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'컴퓨터'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'선풍기'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'선풍기'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'믹서'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'믹서'</span><span class=\"token punctuation\">]</span>\n\n<span class=\"token comment\">#먼저 숫자 값으로 변환을 위해 LabelEncoder로 변환</span>\nencoder<span class=\"token operator\">=</span>LabelEncoder<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\nencoder<span class=\"token punctuation\">.</span>fit<span class=\"token punctuation\">(</span>items<span class=\"token punctuation\">)</span>\nlabels <span class=\"token operator\">=</span> encoder<span class=\"token punctuation\">.</span>transform<span class=\"token punctuation\">(</span>items<span class=\"token punctuation\">)</span>\n<span class=\"token comment\">#2차원 데이터로 변환</span>\nlabels <span class=\"token operator\">=</span> labels<span class=\"token punctuation\">.</span>reshape<span class=\"token punctuation\">(</span><span class=\"token operator\">-</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span>\n\n<span class=\"token comment\">#원-핫 인코딩 적용</span>\noh_encoder <span class=\"token operator\">=</span> OneHotEncoder<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\noh_encoder<span class=\"token punctuation\">.</span>fit<span class=\"token punctuation\">(</span>labels<span class=\"token punctuation\">)</span>\noh_labels<span class=\"token operator\">=</span>oh_encoder<span class=\"token punctuation\">.</span>transform<span class=\"token punctuation\">(</span>labels<span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">'원-핫 인코딩 데이터'</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>oh_labels<span class=\"token punctuation\">.</span>toarray<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span></code></pre></div>\n<p>[실행 결과]</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">원-핫 인코딩 데이터\n[[1. 0. 0. 0. 0. 0.]\n [0. 1. 0. 0. 0. 0.]\n [0. 0. 0. 0. 1. 0.]\n [0. 0. 0. 0. 0. 1.]\n [0. 0. 0. 1. 0. 0.]\n [0. 0. 0. 1. 0. 0.]\n [0. 0. 1. 0. 0. 0.]\n [0. 0. 1. 0. 0. 0.]]</code></pre></div>\n<p>8개의 레코드를 가진 원본 데이터와 8개의 레코드와 상품의 종류 수인 6개의 칼럼을 가진 데이터로 변환된 것을 확인할 수 있습니다.</p>\n<p>판다스에는 원-핫 코딩을 더 쉽게 지원하는 <code class=\"language-text\">get_dummies()</code> 를 사용할 수 있습니다. 이는 <code class=\"language-text\">OneHotEncoder()</code>와는 다르게 문자열 카테고리 값을 바로 변환할 수 있다는 장점을 갖습니다.</p>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token keyword\">import</span> pandas <span class=\"token keyword\">as</span> pd\n\ndf<span class=\"token operator\">=</span>pd<span class=\"token punctuation\">.</span>DataFrame<span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span><span class=\"token string\">'item'</span> <span class=\"token punctuation\">:</span> <span class=\"token punctuation\">[</span><span class=\"token string\">'TV'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'냉장고'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'전자레인지'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'컴퓨터'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'선풍기'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'선풍기'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'믹서'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'믹서'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\npd<span class=\"token punctuation\">.</span>get_dummies<span class=\"token punctuation\">(</span>df<span class=\"token punctuation\">)</span></code></pre></div>\n<p>[실행 결과]\n<span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 590px;\"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 44.33333333333333%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAJCAYAAAAywQxIAAAACXBIWXMAAA7DAAAOwwHHb6hkAAABLElEQVQoz22RSW7DMAxFdZTEs+U5y9opMtV2GqRA7n8YVo+wAi2yMPQpfpKPsimKQs6Xi/wsi0zHoyz3u6yPh3yNo9zmWb9xmjRPDs+8rnJz8d/rJd+nk5yvV/l9PvU0VVVJ3TTStK007qzrWrq+l34YxLrccDhoDl/bdRrjoaYLYjxoU1orSZJIlmVaFO33GnOPtu4sy1J1mqY6NIoiieNYTxrjR1NvCmcOG+63QrtpGvMs/h6asKGvR1OjK+d5rhRgJ85IgxbtjDTAiMbH2ukGwAB83HsIY4OVlWq302T1gVCbOh0SVm7gm9B5DRdMAJ338YTNRkjeD8XHIAZ+IuQ9jV/n/YYQol0jqDJnJqc/ayvyhHzhT9GVWYECzpDEbiTce4LsAyGx19T/A2wSDXRK+IYYAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"실행 결과\"\n        title=\"실행 결과\"\n        src=\"/static/baf367528fc53810c36ac8132c7b4dcb/fcda8/1.png\"\n        srcset=\"/static/baf367528fc53810c36ac8132c7b4dcb/5a46d/1.png 300w,\n/static/baf367528fc53810c36ac8132c7b4dcb/fcda8/1.png 590w\"\n        sizes=\"(max-width: 590px) 100vw, 590px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n    </span></p>\n<h3 id=\"52-피처-스케일링과-정규화\" style=\"position:relative;\"><a href=\"#52-%ED%94%BC%EC%B2%98-%EC%8A%A4%EC%BC%80%EC%9D%BC%EB%A7%81%EA%B3%BC-%EC%A0%95%EA%B7%9C%ED%99%94\" aria-label=\"52 피처 스케일링과 정규화 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>5.2. 피처 스케일링과 정규화</h3>","frontmatter":{"title":"[파이썬 머신러닝 완벽 가이드] 2.사이킷런으로 시작하는 머신러닝(2)","date":"February 03, 2022"}}},"pageContext":{"slug":"/ML/chapter2-2/","previous":{"fields":{"slug":"/ML/chapter2-1/"},"frontmatter":{"title":"[파이썬 머신러닝 완벽 가이드] 2.사이킷런으로 시작하는 머신러닝(1)"}},"next":null}},"staticQueryHashes":["2486386679","3128451518"]}